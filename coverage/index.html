<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Roo</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.8.0/application.js' type='text/javascript'></script>    
    <link href='./assets/0.8.0/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.8.0/favicon_red.png" />
    <link rel="icon" type="image/png" href="./assets/0.8.0/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.8.0/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2014-02-13T23:02:28-05:00">2014-02-13T23:02:28-05:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="red">12.57%</span></span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.13
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>3</b> files in total.
    <b>1663</b> relevant lines. 
    <span class="green"><b>209</b> lines covered</span> and
    <span class="red"><b>1454</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#d0063242fed03bb66fa0d52d566def7b4fffcf6b" class="src_link" title="lib/roo.rb">lib/roo.rb</a></td>
        <td class="red strong">54.55 %</td>
        <td>34</td>
        <td>22</td>
        <td>12</td>
        <td>10</td>
        <td>0.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bfacd34a896575cff525dd358f7e7b40523ee667" class="src_link" title="lib/roo/base.rb">lib/roo/base.rb</a></td>
        <td class="red strong">16.16 %</td>
        <td>835</td>
        <td>427</td>
        <td>69</td>
        <td>358</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#19124092ea169d5837b0238ccd647b01ef6cce69" class="src_link" title="test/test_roo.rb">test/test_roo.rb</a></td>
        <td class="red strong">10.54 %</td>
        <td>2334</td>
        <td>1214</td>
        <td>128</td>
        <td>1086</td>
        <td>0.1</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.8.2 
        and simplecov-html v0.8.0<br/>
        using Unit Tests
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="d0063242fed03bb66fa0d52d566def7b4fffcf6b">
  <div class="header">
    <h3>lib/roo.rb</h3>
    <h4><span class="red">54.55 %</span> covered</h4>
    <div>
      <b>22</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module Roo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  VERSION = '1.12.1'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.const_missing(const_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    case const_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    when :Libreoffice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      warn &quot;`Roo::Libreoffice` has been deprecated. Use `Roo::LibreOffice` instead.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">      LibreOffice</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    when :Openoffice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">      warn &quot;`Roo::Openoffice` has been deprecated. Use `Roo::OpenOffice` instead.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">      OpenOffice</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    when :Csv</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">      warn &quot;`Roo::Csv` has been deprecated. Use `Roo::CSV` instead.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      CSV</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    when :GenericSpreadsheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">      warn &quot;`Roo::GenericSpreadsheet` has been deprecated. Use `Roo::Base` instead.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">      Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">      super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Spreadsheet,  'roo/spreadsheet'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Base,         'roo/base'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :OpenOffice,   'roo/openoffice'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :LibreOffice,  'roo/openoffice'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Excel,        'roo/excel'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Excelx,       'roo/excelx'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Excel2003XML, 'roo/excel2003xml'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :Google,       'roo/google'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  autoload :CSV,          'roo/csv'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="bfacd34a896575cff525dd358f7e7b40523ee667">
  <div class="header">
    <h3>lib/roo/base.rb</h3>
    <h4><span class="red">16.16 %</span> covered</h4>
    <div>
      <b>427</b> relevant lines. 
      <span class="green"><b>69</b> lines covered</span> and
      <span class="red"><b>358</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># encoding: utf-8</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require 'tmpdir'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">require 'stringio'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">begin</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  require 'zip/zipfilesystem'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">  Roo::ZipFile = Zip::ZipFile</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">rescue LoadError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  # For rubyzip &gt;= 1.0.0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  require 'zip/filesystem'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  Roo::ZipFile = Zip::File</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"># Base class for all other types of spreadsheets</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">class Roo::Base</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  include Enumerable</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  TEMP_PREFIX = &quot;oo_&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :default_sheet, :headers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  # sets the line with attribute names (default: 1)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :header_line</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">public</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(filename, options={}, file_warning=:error, tmpdir=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    @filename = filename</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    @options  = options</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    @cell        = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    @cell_type   = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    @cells_read  = {}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    @first_row    = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    @last_row     = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    @first_column = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    @last_column  = {}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    @header_line   = 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    @default_sheet = self.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  # sets the working sheet in the document</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  # 'sheet' can be a number (1 = first sheet) or the name of a sheet.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def default_sheet=(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    validate_sheet!(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    @default_sheet = sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    @first_row[sheet]    = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    @last_row[sheet]     = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">    @first_column[sheet] = nil </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    @last_column[sheet]  = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    @cells_read[sheet]   = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  # first non-empty column as a letter</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def first_column_as_letter(sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    Roo::Base.number_to_letter(first_column(sheet))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  # last non-empty column as a letter</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">  def last_column_as_letter(sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">    Roo::Base.number_to_letter(last_column(sheet))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  #TODO These next four methods use a lot of repeatable logic.  Refactor.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  # returns the number of the first non-empty row</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">  def first_row(sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    read_cells(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">    if @first_row[sheet]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">      return @first_row[sheet]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    impossible_value = 999_999 # more than a spreadsheet can hold</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    result = impossible_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">    if @cell[sheet]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">      @cell[sheet].each_pair do |key,value|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">        y = key.first.to_i # _to_string(key).split(',')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">        result = [result, y].min if value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">    result = nil if result == impossible_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">    @first_row[sheet] = result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">    return result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  # returns the number of the last non-empty row</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  def last_row(sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">    read_cells(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    if @last_row[sheet]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">      return @last_row[sheet]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">    impossible_value = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">    result = impossible_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">    @cell[sheet].each_pair {|key,value|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">      y = key.first.to_i # _to_string(key).split(',')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">      result = [result, y].max if value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">    } if @cell[sheet]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">    result = nil if result == impossible_value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">    @last_row[sheet] = result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  # returns the number of the first non-empty column</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">  def first_column(sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">    read_cells(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">    if @first_column[sheet]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">      return @first_column[sheet]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">    impossible_value = 999_999 # more than a spreadsheet can hold</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">    result = impossible_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">    @cell[sheet].each_pair {|key,value|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">      x = key.last.to_i # _to_string(key).split(',')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">      result = [result, x].min if value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">    } if @cell[sheet]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">    result = nil if result == impossible_value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">    @first_column[sheet] = result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">  # returns the number of the last non-empty column</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">  def last_column(sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">    read_cells(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">    if @last_column[sheet]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">      return @last_column[sheet]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">    impossible_value = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">    result = impossible_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">    @cell[sheet].each_pair {|key,value|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">      x = key.last.to_i # _to_string(key).split(',')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">      result = [result, x].max if value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">    } if @cell[sheet]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">    result = nil if result == impossible_value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">    @last_column[sheet] = result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">  # returns a rectangular area (default: all cells) as yaml-output</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">  # you can add additional attributes with the prefix parameter like:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  # oo.to_yaml({&quot;file&quot;=&gt;&quot;flightdata_2007-06-26&quot;, &quot;sheet&quot; =&gt; &quot;1&quot;})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="153">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_yaml(prefix={}, from_row=nil, from_column=nil, to_row=nil, to_column=nil,sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">    result = &quot;--- \n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="156">
          
          
          <code class="ruby">    return '' unless first_row # empty result if there is no first_row in a sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">    (from_row||first_row(sheet)).upto(to_row||last_row(sheet)) do |row|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">      (from_column||first_column(sheet)).upto(to_column||last_column(sheet)) do |col|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">        unless empty?(row,col,sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">          result &lt;&lt; &quot;cell_#{row}_#{col}: \n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">          prefix.each {|k,v|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">            result &lt;&lt; &quot;  #{k}: #{v} \n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">          result &lt;&lt; &quot;  row: #{row} \n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">          result &lt;&lt; &quot;  col: #{col} \n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">          result &lt;&lt; &quot;  celltype: #{self.celltype(row,col,sheet)} \n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">          if self.celltype(row,col,sheet) == :time</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">            result &lt;&lt; &quot;  value: #{Roo::Base.integer_to_timestring( self.cell(row,col,sheet))} \n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">            result &lt;&lt; &quot;  value: #{self.cell(row,col,sheet)} \n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="176">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">  # write the current spreadsheet to stdout or into a file</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="180">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_csv(filename=nil,sheet=nil,separator=',')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="181">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="182">
          
          
          <code class="ruby">    if filename</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">      File.open(filename,&quot;w&quot;) do |file|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">        write_csv_content(file,sheet,separator)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="186">
          
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="188">
          
          
          <code class="ruby">      sio = StringIO.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">      write_csv_content(sio,sheet,separator)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="190">
          
          
          <code class="ruby">      sio.rewind</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">      return sio.read</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">  # returns a matrix object from the whole sheet or a rectangular area of a sheet</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="196">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_matrix(from_row=nil, from_column=nil, to_row=nil, to_column=nil,sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="197">
          
          
          <code class="ruby">    require 'matrix'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="200">
          
          
          <code class="ruby">    return Matrix.empty unless first_row</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">    Matrix.rows((from_row||first_row(sheet)).upto(to_row||last_row(sheet)).map do |row|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">      (from_column||first_column(sheet)).upto(to_column||last_column(sheet)).map do |col|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="204">
          
          
          <code class="ruby">        cell(row,col,sheet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">    end)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">  # find a row either by row number or a condition</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  # Caution: this works only within the default sheet -&gt; set default_sheet before you call this method</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">  # (experimental. see examples in the test_roo.rb file)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>
          
          <code class="ruby">  def find(*args) # :nodoc</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="213">
          
          
          <code class="ruby">    options = (args.last.is_a?(Hash) ? args.pop : {})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">    if args[0].class == Fixnum</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="216">
          
          
          <code class="ruby">      find_by_row(args)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">    elsif args[0] == :all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">      find_by_conditions(options)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">  # returns all values in this row as an array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">  # row numbers are 1,2,3,... like in the spreadsheet</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="224">
          <span class="hits">1</span>
          
          <code class="ruby">  def row(rownumber,sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="225">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="226">
          
          
          <code class="ruby">    read_cells(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="227">
          
          
          <code class="ruby">    first_column(sheet).upto(last_column(sheet)).map do |col|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="228">
          
          
          <code class="ruby">      cell(rownumber,col,sheet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">  # returns all values in this column as an array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">  # column numbers are 1,2,3,... like in the spreadsheet</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="234">
          <span class="hits">1</span>
          
          <code class="ruby">  def column(columnnumber,sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">    if columnnumber.class == String</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">      columnnumber = Roo::Excel.letter_to_number(columnnumber)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="238">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="239">
          
          
          <code class="ruby">    read_cells(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="240">
          
          
          <code class="ruby">    first_row(sheet).upto(last_row(sheet)).map do |row|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="241">
          
          
          <code class="ruby">      cell(row,columnnumber,sheet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">  # set a cell to a certain value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">  # (this will not be saved back to the spreadsheet file!)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="247">
          <span class="hits">1</span>
          
          <code class="ruby">  def set(row,col,value,sheet=nil) #:nodoc:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="248">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="249">
          
          
          <code class="ruby">    read_cells(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="250">
          
          
          <code class="ruby">    row, col = normalize(row,col)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">    cell_type = case value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="252">
          
          
          <code class="ruby">                when Fixnum then :float</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="253">
          
          
          <code class="ruby">                when String, Float then :string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">                else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">                  raise ArgumentError, &quot;Type for #{value} not set&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">    set_value(row,col,value,sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">    set_type(row,col,cell_type,sheet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">  # reopens and read a spreadsheet document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="263">
          <span class="hits">1</span>
          
          <code class="ruby">  def reload</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="264">
          
          
          <code class="ruby">    ds = @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="265">
          
          
          <code class="ruby">    reinitialize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">    self.default_sheet = ds</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">  # true if cell is empty</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="270">
          <span class="hits">1</span>
          
          <code class="ruby">  def empty?(row, col, sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="271">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="272">
          
          
          <code class="ruby">    read_cells(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="273">
          
          
          <code class="ruby">    row,col = normalize(row,col)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="274">
          
          
          <code class="ruby">    contents = cell(row, col, sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="275">
          
          
          <code class="ruby">    !contents || (celltype(row, col, sheet) == :string &amp;&amp; contents.empty?) \</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">      || (row &lt; first_row(sheet) || row &gt; last_row(sheet) || col &lt; first_column(sheet) || col &gt; last_column(sheet))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby">  # returns information of the spreadsheet document and all sheets within</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">  # this document.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="281">
          <span class="hits">1</span>
          
          <code class="ruby">  def info</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="282">
          
          
          <code class="ruby">    without_changing_default_sheet do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="283">
          
          
          <code class="ruby">      result = &quot;File: #{File.basename(@filename)}\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">        &quot;Number of sheets: #{sheets.size}\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">        &quot;Sheets: #{sheets.join(', ')}\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="286">
          
          
          <code class="ruby">      n = 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">      sheets.each {|sheet|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">        self.default_sheet = sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="289">
          
          
          <code class="ruby">        result &lt;&lt; &quot;Sheet &quot; + n.to_s + &quot;:\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">        unless first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="291">
          
          
          <code class="ruby">          result &lt;&lt; &quot;  - empty -&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">          result &lt;&lt; &quot;  First row: #{first_row}\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="294">
          
          
          <code class="ruby">          result &lt;&lt; &quot;  Last row: #{last_row}\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="295">
          
          
          <code class="ruby">          result &lt;&lt; &quot;  First column: #{Roo::Base.number_to_letter(first_column)}\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="296">
          
          
          <code class="ruby">          result &lt;&lt; &quot;  Last column: #{Roo::Base.number_to_letter(last_column)}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="298">
          
          
          <code class="ruby">        result &lt;&lt; &quot;\n&quot; if sheet != sheets.last</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">        n += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">      result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">  # returns an XML representation of all sheets of a spreadsheet file</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="306">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_xml</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">    Nokogiri::XML::Builder.new do |xml|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="308">
          
          
          <code class="ruby">      xml.spreadsheet do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="309">
          
          
          <code class="ruby">        self.sheets.each do |sheet|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">          self.default_sheet = sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">          xml.sheet(:name =&gt; sheet) do |x|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="312">
          
          
          <code class="ruby">            if first_row and last_row and first_column and last_column</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">              # sonst gibt es Fehler bei leeren Blaettern</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="314">
          
          
          <code class="ruby">              first_row.upto(last_row) do |row|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="315">
          
          
          <code class="ruby">                first_column.upto(last_column) do |col|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">                  unless empty?(row,col)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">                    x.cell(cell(row,col),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby">                      :row =&gt;row,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby">                      :column =&gt; col,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="320">
          
          
          <code class="ruby">                      :type =&gt; celltype(row,col))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby">                  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">                end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby">    end.to_xml</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">  # when a method like spreadsheet.a42 is called</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby">  # convert it to a call of spreadsheet.cell('a',42)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="333">
          <span class="hits">1</span>
          
          <code class="ruby">  def method_missing(m, *args)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">    # #aa42 =&gt; #cell('aa',42)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby">    # #aa42('Sheet1')  =&gt; #cell('aa',42,'Sheet1')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="336">
          
          
          <code class="ruby">    if m =~ /^([a-z]+)(\d)$/</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="337">
          
          
          <code class="ruby">      col = Roo::Base.letter_to_number($1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">      row = $2.to_i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="339">
          
          
          <code class="ruby">      if args.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="340">
          
          
          <code class="ruby">        cell(row,col)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="342">
          
          
          <code class="ruby">        cell(row,col,args.first)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="344">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">      super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="349">
          
          
          <code class="ruby">  # access different worksheets by calling spreadsheet.sheet(1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="350">
          
          
          <code class="ruby">  # or spreadsheet.sheet('SHEETNAME')</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="351">
          <span class="hits">1</span>
          
          <code class="ruby">  def sheet(index,name=false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="352">
          
          
          <code class="ruby">    @default_sheet = String === index ? index : self.sheets[index]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">    name ? [@default_sheet,self] : self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby">  # iterate through all worksheets of a document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="357">
          <span class="hits">1</span>
          
          <code class="ruby">  def each_with_pagename</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="358">
          
          
          <code class="ruby">    self.sheets.each do |s|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="359">
          
          
          <code class="ruby">      yield sheet(s,true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="360">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">  # by passing in headers as options, this method returns</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby">  # specific columns from your header assignment</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">  # for example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby">  # xls.sheet('New Prices').parse(:upc =&gt; 'UPC', :price =&gt; 'Price') would return:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="367">
          
          
          <code class="ruby">  # [{:upc =&gt; 123456789012, :price =&gt; 35.42},..]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby">  # the queries are matched with regex, so regex options can be passed in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby">  # such as :price =&gt; '^(Cost|Price)'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">  # case insensitive by default</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby">  # by using the :header_search option, you can query for headers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">  # and return a hash of every row with the keys set to the header result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby">  # for example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="377">
          
          
          <code class="ruby">  # xls.sheet('New Prices').parse(:header_search =&gt; ['UPC*SKU','^Price*\sCost\s'])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="378">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby">  # that example searches for a column titled either UPC or SKU and another</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="380">
          
          
          <code class="ruby">  # column titled either Price or Cost (regex characters allowed)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby">  # * is the wildcard character</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby">  # you can also pass in a :clean =&gt; true option to strip the sheet of</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="384">
          
          
          <code class="ruby">  # odd unicode characters and white spaces around columns</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="385">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="386">
          <span class="hits">1</span>
          
          <code class="ruby">  def each(options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="387">
          
          
          <code class="ruby">    if options.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="388">
          
          
          <code class="ruby">      1.upto(last_row) do |line|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="389">
          
          
          <code class="ruby">        yield row(line)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="392">
          
          
          <code class="ruby">      if options[:clean]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="393">
          
          
          <code class="ruby">        options.delete(:clean)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="394">
          
          
          <code class="ruby">        @cleaned ||= {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="395">
          
          
          <code class="ruby">        @cleaned[@default_sheet] || clean_sheet(@default_sheet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="398">
          
          
          <code class="ruby">      if options[:header_search]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="399">
          
          
          <code class="ruby">        @headers = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="400">
          
          
          <code class="ruby">        @header_line = row_with(options[:header_search])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="401">
          
          
          <code class="ruby">      elsif [:first_row,true].include?(options[:headers])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="402">
          
          
          <code class="ruby">        @headers = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="403">
          
          
          <code class="ruby">        row(first_row).each_with_index {|x,i| @headers &lt;&lt; [x,i + 1]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="405">
          
          
          <code class="ruby">        set_headers(options)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="408">
          
          
          <code class="ruby">      headers = @headers ||</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="409">
          
          
          <code class="ruby">        Hash[(first_column..last_column).map do |col|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="410">
          
          
          <code class="ruby">          [cell(@header_line,col), col]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="411">
          
          
          <code class="ruby">        end]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="413">
          
          
          <code class="ruby">      @header_line.upto(last_row) do |line|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="414">
          
          
          <code class="ruby">        yield(Hash[headers.map {|k,v| [k,cell(line,v)]}])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="417">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="418">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="419">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse(options={})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="420">
          
          
          <code class="ruby">    ary = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="421">
          
          
          <code class="ruby">    if block_given?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="422">
          
          
          <code class="ruby">      each(options) {|row| ary &lt;&lt; yield(row)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="424">
          
          
          <code class="ruby">      each(options) {|row| ary &lt;&lt; row}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="425">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="426">
          
          
          <code class="ruby">    ary</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="428">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="429">
          <span class="hits">1</span>
          
          <code class="ruby">  def row_with(query,return_headers=false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">    query.map! {|x| Array(x.split('*'))}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="431">
          
          
          <code class="ruby">    line_no = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="432">
          
          
          <code class="ruby">    each do |row|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="433">
          
          
          <code class="ruby">      line_no += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="434">
          
          
          <code class="ruby">      # makes sure headers is the first part of wildcard search for priority</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="435">
          
          
          <code class="ruby">      # ex. if UPC and SKU exist for UPC*SKU search, UPC takes the cake</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="436">
          
          
          <code class="ruby">      headers = query.map do |q|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="437">
          
          
          <code class="ruby">        q.map {|i| row.grep(/#{i}/i)[0]}.compact[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby">      end.compact</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="439">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="440">
          
          
          <code class="ruby">      if headers.length == query.length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="441">
          
          
          <code class="ruby">        @header_line = line_no</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="442">
          
          
          <code class="ruby">        return return_headers ? headers : line_no</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="443">
          
          
          <code class="ruby">      elsif line_no &gt; 100</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="444">
          
          
          <code class="ruby">        raise &quot;Couldn't find header row.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="445">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="446">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="447">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="448">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="449">
          <span class="hits">1</span>
          
          <code class="ruby">protected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="450">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="451">
          
          
          <code class="ruby">  # </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="452">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.split_coordinate(str)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="453">
          
          
          <code class="ruby">    letter,number = Roo::Base.split_coord(str)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="454">
          
          
          <code class="ruby">    x = letter_to_number(letter)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="455">
          
          
          <code class="ruby">    y = number</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="456">
          
          
          <code class="ruby">    return y, x</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="457">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="458">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="459">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="460">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="461">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.split_coord(s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="462">
          
          
          <code class="ruby">    if s =~ /([a-zA-Z]+)([0-9]+)/</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="463">
          
          
          <code class="ruby">      letter = $1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="464">
          
          
          <code class="ruby">      number = $2.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="465">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="466">
          
          
          <code class="ruby">      raise ArgumentError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="468">
          
          
          <code class="ruby">    return letter, number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="469">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="470">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby">  # Loads XML from a path</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="473">
          <span class="hits">1</span>
          
          <code class="ruby">  def load_xml(path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="474">
          
          
          <code class="ruby">    File.open(path) do |file|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="475">
          
          
          <code class="ruby">      Nokogiri::XML(file)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="476">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="477">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="478">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="479">
          
          
          <code class="ruby">  # TODO This does something, but I have no idea what or why.  Figure it out and comment.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="480">
          <span class="hits">1</span>
          
          <code class="ruby">  def file_type_check(filename, ext, name, warning_level, packed=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="481">
          
          
          <code class="ruby">    new_expression = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="482">
          
          
          <code class="ruby">      '.ods'  =&gt; 'Roo::OpenOffice.new',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="483">
          
          
          <code class="ruby">      '.xls'  =&gt; 'Roo::Excel.new',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="484">
          
          
          <code class="ruby">      '.xlsx' =&gt; 'Roo::Excelx.new',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby">      '.csv'  =&gt; 'Roo::CSV.new',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="486">
          
          
          <code class="ruby">      '.xml'  =&gt; 'Roo::Excel2003XML.new',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="487">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="488">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="489">
          
          
          <code class="ruby">    if packed == :zip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby">	    # lalala.ods.zip =&gt; lalala.ods</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="491">
          
          
          <code class="ruby">	    # Here is NOT made ​​unzip, but only the name of the file </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="492">
          
          
          <code class="ruby">      # Tested, if it is a compressed file.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="493">
          
          
          <code class="ruby">	    filename = File.basename(filename,File.extname(filename))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="494">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="495">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="496">
          
          
          <code class="ruby">    case ext</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="497">
          
          
          <code class="ruby">    when '.ods', '.xls', '.xlsx', '.csv', '.xml'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="498">
          
          
          <code class="ruby">      correct_class = &quot;use #{new_expression[ext]} to handle #{ext} spreadsheet files. This has #{File.extname(filename).downcase}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="499">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="500">
          
          
          <code class="ruby">      raise &quot;unknown file type: #{ext}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="501">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="502">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="503">
          
          
          <code class="ruby">    if uri?(filename) &amp;&amp; qs_begin = filename.rindex('?')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="504">
          
          
          <code class="ruby">      filename = filename[0..qs_begin-1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="505">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="506">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="507">
          
          
          <code class="ruby">    if File.extname(filename).downcase != ext</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="508">
          
          
          <code class="ruby">      case warning_level</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="509">
          
          
          <code class="ruby">      when :error</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="510">
          
          
          <code class="ruby">        warn correct_class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="511">
          
          
          <code class="ruby">        raise TypeError, &quot;#{filename} is not #{name} file&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="512">
          
          
          <code class="ruby">      when :warning</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="513">
          
          
          <code class="ruby">        warn &quot;are you sure, this is #{name} spreadsheet file?&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="514">
          
          
          <code class="ruby">        warn correct_class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="515">
          
          
          <code class="ruby">      when :ignore</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="516">
          
          
          <code class="ruby">        # ignore</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="517">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="518">
          
          
          <code class="ruby">        raise &quot;#{warning_level} illegal state of file_warning&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="519">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="520">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="521">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="522">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="523">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="524">
          
          
          <code class="ruby">  # Converts a key of the form &quot;12.45&quot; (= row, column) in </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="525">
          
          
          <code class="ruby">  # An array with numeric values ​​([12,45])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="526">
          
          
          <code class="ruby">  # This method is a temp. Solution in order to explore whether the </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="527">
          
          
          <code class="ruby">  # Access with numeric keys is faster.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="528">
          <span class="hits">1</span>
          
          <code class="ruby">  def key_to_num(str)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="529">
          
          
          <code class="ruby">    r,c = str.split(',')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="530">
          
          
          <code class="ruby">    [r.to_i,c.to_i]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="531">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="532">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="533">
          
          
          <code class="ruby">  # see: key_to_num</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="534">
          <span class="hits">1</span>
          
          <code class="ruby">  def key_to_string(arr)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="535">
          
          
          <code class="ruby">    &quot;#{arr[0]},#{arr[1]}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="536">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="537">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="538">
          <span class="hits">1</span>
          
          <code class="ruby">private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="539">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="540">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_row(args)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="541">
          
          
          <code class="ruby">    rownum = args[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="542">
          
          
          <code class="ruby">    current_row = rownum</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="543">
          
          
          <code class="ruby">    current_row += header_line - 1 if @header_line</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="544">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="545">
          
          
          <code class="ruby">    self.row(current_row).size.times.map do |j|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="546">
          
          
          <code class="ruby">      cell(current_row, j + 1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="548">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="549">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="550">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_conditions(options)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="551">
          
          
          <code class="ruby">    rows = first_row.upto(last_row)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="552">
          
          
          <code class="ruby">    result_array = options[:array]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="553">
          
          
          <code class="ruby">    header_for = Hash[1.upto(last_column).map do |col|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="554">
          
          
          <code class="ruby">      [col, cell(@header_line,col)]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="555">
          
          
          <code class="ruby">    end]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="556">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="557">
          
          
          <code class="ruby">    # are all conditions met?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="558">
          
          
          <code class="ruby">    if (conditions = options[:conditions]) &amp;&amp; !conditions.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="559">
          
          
          <code class="ruby">      column_with = header_for.invert</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="560">
          
          
          <code class="ruby">      rows = rows.select do |i|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="561">
          
          
          <code class="ruby">        conditions.all? { |key,val| cell(i,column_with[key]) == val }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="562">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="563">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="564">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="565">
          
          
          <code class="ruby">    rows.map do |i|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="566">
          
          
          <code class="ruby">      if result_array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="567">
          
          
          <code class="ruby">        self.row(i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="568">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="569">
          
          
          <code class="ruby">        Hash[1.upto(self.row(i).size).map do |j|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="570">
          
          
          <code class="ruby">          [header_for.fetch(j), cell(i,j)]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="571">
          
          
          <code class="ruby">        end]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="572">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="573">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="574">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="575">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="576">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="577">
          <span class="hits">1</span>
          
          <code class="ruby">  def without_changing_default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="578">
          
          
          <code class="ruby">    original_default_sheet = default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="579">
          
          
          <code class="ruby">    yield</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="580">
          
          
          <code class="ruby">  ensure</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="581">
          
          
          <code class="ruby">    self.default_sheet = original_default_sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="582">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="583">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="584">
          <span class="hits">1</span>
          
          <code class="ruby">  def reinitialize</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="585">
          
          
          <code class="ruby">    initialize(@filename)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="586">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="587">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="588">
          <span class="hits">1</span>
          
          <code class="ruby">  def make_tmpdir(tmp_root = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="589">
          
          
          <code class="ruby">    Dir.mktmpdir(TEMP_PREFIX, tmp_root || ENV['ROO_TMP']) do |tmpdir|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="590">
          
          
          <code class="ruby">      yield tmpdir</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="591">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="592">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="593">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="594">
          <span class="hits">1</span>
          
          <code class="ruby">  def clean_sheet(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="595">
          
          
          <code class="ruby">    read_cells(sheet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="596">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="597">
          
          
          <code class="ruby">    @cell[sheet].each_pair do |coord,value|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="598">
          
          
          <code class="ruby">      if String === value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="599">
          
          
          <code class="ruby">        @cell[sheet][coord] = sanitize_value(value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="600">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="601">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="602">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="603">
          
          
          <code class="ruby">    @cleaned[sheet] = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="604">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="605">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="606">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="607">
          
          
          <code class="ruby">  # What does this do?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="608">
          <span class="hits">1</span>
          
          <code class="ruby">  def sanitize_value(v)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="609">
          
          
          <code class="ruby">    v.strip.unpack('U*').select {|b| b &lt; 127}.pack('U*')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="610">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="611">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="612">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_headers(hash={})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="613">
          
          
          <code class="ruby">    # try to find header row with all values or give an error</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="614">
          
          
          <code class="ruby">    # then create new hash by indexing strings and keeping integers for header array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="615">
          
          
          <code class="ruby">    @headers = row_with(hash.values,true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="616">
          
          
          <code class="ruby">    @headers = Hash[hash.keys.zip(@headers.map {|x| header_index(x)})]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="617">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="618">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="619">
          <span class="hits">1</span>
          
          <code class="ruby">  def header_index(query)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="620">
          
          
          <code class="ruby">    row(@header_line).index(query) + first_column</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="621">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="622">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="623">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_value(row,col,value,sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="624">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="625">
          
          
          <code class="ruby">    @cell[sheet][[row,col]] = value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="626">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="627">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="628">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_type(row,col,type,sheet=nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="629">
          
          
          <code class="ruby">    sheet ||= @default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="630">
          
          
          <code class="ruby">    @cell_type[sheet][[row,col]] = type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="631">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="633">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="634">
          
          
          <code class="ruby">  # converts cell coordinate to numeric values of row,col</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="635">
          <span class="hits">1</span>
          
          <code class="ruby">  def normalize(row,col)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="636">
          
          
          <code class="ruby">    if row.class == String</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="637">
          
          
          <code class="ruby">      if col.class == Fixnum</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="638">
          
          
          <code class="ruby">        # ('A',1):</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="639">
          
          
          <code class="ruby">        # ('B', 5) -&gt; (5, 2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="640">
          
          
          <code class="ruby">        row, col = col, row</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="641">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="642">
          
          
          <code class="ruby">        raise ArgumentError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="643">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="644">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="645">
          
          
          <code class="ruby">    if col.class == String</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="646">
          
          
          <code class="ruby">      col = Roo::Base.letter_to_number(col)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="647">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="648">
          
          
          <code class="ruby">    return row,col</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="649">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="650">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="651">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="652">
          
          
          <code class="ruby">  # TODO: More robust check</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="653">
          <span class="hits">1</span>
          
          <code class="ruby">  def uri?(filename)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="654">
          
          
          <code class="ruby">    filename.start_with?(&quot;http://&quot;, &quot;https://&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="655">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="656">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="657">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="658">
          
          
          <code class="ruby">  # Add option for download to RAM</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="659">
          <span class="hits">1</span>
          
          <code class="ruby">  def download_uri(uri, tmpdir)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="660">
          
          
          <code class="ruby">    require 'open-uri'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="661">
          
          
          <code class="ruby">    tempfilename = File.join(tmpdir, File.basename(uri))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="662">
          
          
          <code class="ruby">    response = ''</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="663">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="664">
          
          
          <code class="ruby">      File.open(tempfilename,&quot;wb&quot;) do |file|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="665">
          
          
          <code class="ruby">        open(uri, &quot;User-Agent&quot; =&gt; &quot;Ruby/#{RUBY_VERSION}&quot;) { |net|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="666">
          
          
          <code class="ruby">          file.write(net.read)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="667">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="668">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="669">
          
          
          <code class="ruby">    rescue OpenURI::HTTPError</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="670">
          
          
          <code class="ruby">      raise &quot;could not open #{uri}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="671">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="672">
          
          
          <code class="ruby">    tempfilename</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="673">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="674">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="675">
          
          
          <code class="ruby">  #TODO This is a foolish non-thread safe manner of opening spreadsheets</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="676">
          <span class="hits">1</span>
          
          <code class="ruby">  def open_from_stream(stream, tmpdir)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="677">
          
          
          <code class="ruby">    tempfilename = File.join(tmpdir, &quot;spreadsheet&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="678">
          
          
          <code class="ruby">    File.open(tempfilename,&quot;wb&quot;) do |file|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="679">
          
          
          <code class="ruby">      file.write(stream[7..-1])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="680">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="681">
          
          
          <code class="ruby">    File.join(tmpdir, &quot;spreadsheet&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="682">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="683">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="684">
          <span class="hits">1</span>
          
          <code class="ruby">  LETTERS = %w{A B C D E F G H I J K L M N O P Q R S T U V W X Y Z}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="685">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="686">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="687">
          
          
          <code class="ruby">  # Convert a number to letters as per the standard spreadsheet columnation </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="688">
          
          
          <code class="ruby">  # eg. 27 =&gt; 'AA' (1 =&gt; 'A', 2 =&gt; 'B', ...)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="689">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.number_to_letter(number)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="690">
          
          
          <code class="ruby">    result = &quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="691">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="692">
          
          
          <code class="ruby">    while number &gt; 0 do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="693">
          
          
          <code class="ruby">      modulo = (number - 1) % 26;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="694">
          
          
          <code class="ruby">      number = (number - modulo) / 26</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="695">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="696">
          
          
          <code class="ruby">      result += LETTERS[modulo]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="697">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="698">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="699">
          
          
          <code class="ruby">    return result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="700">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="701">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="702">
          
          
          <code class="ruby">  # convert letters like 'AB' to a number ('A' =&gt; 1, 'B' =&gt; 2, ...)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="703">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="704">
          
          
          <code class="ruby">  # Convert a letters to numbers as per the standard spreadsheet columnation </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="705">
          
          
          <code class="ruby">  # eg. 'AA' =&gt; 27 (1 =&gt; 'A', 2 =&gt; 'B', ...)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="706">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.letter_to_number(letters)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="707">
          
          
          <code class="ruby">    result = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="708">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="709">
          
          
          <code class="ruby">    while letters &amp;&amp; letters.length &gt; 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="710">
          
          
          <code class="ruby">      character = letters[0,1].upcase</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="711">
          
          
          <code class="ruby">      num = LETTERS.index(character)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="712">
          
          
          <code class="ruby">      raise ArgumentError, &quot;invalid column character '#{letters[0,1]}'&quot; if num == nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="713">
          
          
          <code class="ruby">      num += 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="714">
          
          
          <code class="ruby">      result  = result * 26 + num</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="715">
          
          
          <code class="ruby">      letters = letters[1..-1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="716">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="717">
          
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="718">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="719">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="720">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="721">
          
          
          <code class="ruby">  # Converts an integer value to a time string like '02:05:06'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="722">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.integer_to_timestring(content)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="723">
          
          
          <code class="ruby">    h = (content/3600.0).floor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="724">
          
          
          <code class="ruby">    content = content - h*3600</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="725">
          
          
          <code class="ruby">    m = (content/60.0).floor</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="726">
          
          
          <code class="ruby">    content = content - m*60</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="727">
          
          
          <code class="ruby">    s = content</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="728">
          
          
          <code class="ruby">    sprintf(&quot;%02d:%02d:%02d&quot;, h, m, s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="729">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="730">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="731">
          <span class="hits">1</span>
          
          <code class="ruby">  def unzip(filename, tmpdir)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="732">
          
          
          <code class="ruby">    Roo::ZipFile.open(filename) do |zip|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="733">
          
          
          <code class="ruby">      process_zipfile_packed(zip, tmpdir)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="734">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="735">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="736">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="737">
          
          
          <code class="ruby">  # check if default_sheet was set and exists in sheets-array</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="738">
          <span class="hits">1</span>
          
          <code class="ruby">  def validate_sheet!(sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="739">
          
          
          <code class="ruby">    case sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="740">
          
          
          <code class="ruby">    when nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="741">
          
          
          <code class="ruby">      raise ArgumentError, &quot;Error: sheet 'nil' not valid&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="742">
          
          
          <code class="ruby">    when Fixnum</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="743">
          
          
          <code class="ruby">      self.sheets.fetch(sheet-1) do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="744">
          
          
          <code class="ruby">        raise RangeError, &quot;sheet index #{sheet} not found&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="745">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="746">
          
          
          <code class="ruby">    when String</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="747">
          
          
          <code class="ruby">      if !sheets.include? sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="748">
          
          
          <code class="ruby">        raise RangeError, &quot;sheet '#{sheet}' not found&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="749">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="750">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="751">
          
          
          <code class="ruby">      raise TypeError, &quot;not a valid sheet type: #{sheet.inspect}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="752">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="753">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="754">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="755">
          <span class="hits">1</span>
          
          <code class="ruby">  def process_zipfile_packed(zip, tmpdir, path='')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="756">
          
          
          <code class="ruby">    if zip.file.file? path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="757">
          
          
          <code class="ruby">      # extract and return filename</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="758">
          
          
          <code class="ruby">      File.open(File.join(tmpdir, path),&quot;wb&quot;) do |file|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="759">
          
          
          <code class="ruby">        file.write(zip.read(path))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="760">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="761">
          
          
          <code class="ruby">      File.join(tmpdir, path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="762">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="763">
          
          
          <code class="ruby">      ret=nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="764">
          
          
          <code class="ruby">      path += '/' unless path.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="765">
          
          
          <code class="ruby">      zip.dir.foreach(path) do |filename|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="766">
          
          
          <code class="ruby">        ret = process_zipfile_packed(zip, tmpdir, path + filename)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="767">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="768">
          
          
          <code class="ruby">      ret</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="769">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="770">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="771">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="772">
          
          
          <code class="ruby">  # Write all cells to the csv file. File can be a filename or nil. If the this</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="773">
          
          
          <code class="ruby">  # parameter is nil the output goes to STDOUT</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="774">
          <span class="hits">1</span>
          
          <code class="ruby">  def write_csv_content(file=nil,sheet=nil,separator=',')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="775">
          
          
          <code class="ruby">    file ||= STDOUT</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="776">
          
          
          <code class="ruby">    if first_row(sheet) # sheet is not empty</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="777">
          
          
          <code class="ruby">      1.upto(last_row(sheet)) do |row|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="778">
          
          
          <code class="ruby">        1.upto(last_column(sheet)) do |col|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="779">
          
          
          <code class="ruby">          file.print(separator) if col &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="780">
          
          
          <code class="ruby">          file.print cell_to_csv(row,col,sheet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="781">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="782">
          
          
          <code class="ruby">        file.print(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="783">
          
          
          <code class="ruby">      end # sheet not empty</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="784">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="785">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="786">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="787">
          
          
          <code class="ruby">  # The content of a cell in the csv output</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="788">
          <span class="hits">1</span>
          
          <code class="ruby">  def cell_to_csv(row, col, sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="789">
          
          
          <code class="ruby">    if empty?(row,col,sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="790">
          
          
          <code class="ruby">      ''</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="791">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="792">
          
          
          <code class="ruby">      onecell = cell(row,col,sheet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="793">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="794">
          
          
          <code class="ruby">      case celltype(row,col,sheet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="795">
          
          
          <code class="ruby">      when :string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="796">
          
          
          <code class="ruby">        unless onecell.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="797">
          
          
          <code class="ruby">          %{&quot;#{onecell.gsub(/&quot;/,'&quot;&quot;')}&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="798">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="799">
          
          
          <code class="ruby">      when :boolean</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="800">
          
          
          <code class="ruby">        %{&quot;#{onecell.gsub(/&quot;/,'&quot;&quot;').downcase}&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="801">
          
          
          <code class="ruby">      when :float, :percentage</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="802">
          
          
          <code class="ruby">        if onecell == onecell.to_i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="803">
          
          
          <code class="ruby">          onecell.to_i.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="804">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="805">
          
          
          <code class="ruby">          onecell.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="806">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="807">
          
          
          <code class="ruby">      when :formula</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="808">
          
          
          <code class="ruby">        case onecell</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="809">
          
          
          <code class="ruby">        when String</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="810">
          
          
          <code class="ruby">          unless onecell.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="811">
          
          
          <code class="ruby">            %{&quot;#{onecell.gsub(/&quot;/,'&quot;&quot;')}&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="812">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="813">
          
          
          <code class="ruby">        when Float</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="814">
          
          
          <code class="ruby">          if onecell == onecell.to_i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="815">
          
          
          <code class="ruby">            onecell.to_i.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="816">
          
          
          <code class="ruby">          else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="817">
          
          
          <code class="ruby">            onecell.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="818">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="819">
          
          
          <code class="ruby">        when DateTime</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="820">
          
          
          <code class="ruby">          onecell.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="821">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="822">
          
          
          <code class="ruby">          raise &quot;unhandled onecell-class #{onecell.class}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="823">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="824">
          
          
          <code class="ruby">      when :date, :datetime</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="825">
          
          
          <code class="ruby">        onecell.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="826">
          
          
          <code class="ruby">      when :time</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="827">
          
          
          <code class="ruby">        Roo::Base.integer_to_timestring(onecell)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="828">
          
          
          <code class="ruby">      when :link</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="829">
          
          
          <code class="ruby">          %{&quot;#{onecell.url.gsub(/&quot;/,'&quot;&quot;')}&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="830">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="831">
          
          
          <code class="ruby">        raise &quot;unhandled celltype #{celltype(row,col,sheet)}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="832">
          
          
          <code class="ruby">      end || &quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="833">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="834">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="835">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="19124092ea169d5837b0238ccd647b01ef6cce69">
  <div class="header">
    <h3>test/test_roo.rb</h3>
    <h4><span class="red">10.54 %</span> covered</h4>
    <div>
      <b>1214</b> relevant lines. 
      <span class="green"><b>128</b> lines covered</span> and
      <span class="red"><b>1086</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># encoding: utf-8</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># German: damit keine falschen Vermutungen aufkommen: Ich habe religioes rein gar nichts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># mit diesem Bibelbund zu tun, aber die hatten eine ziemlich grosse</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># Spreadsheet-Datei mit ca. 3500 Zeilen oeffentlich im Netz, die sich ganz gut</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># zum Testen eignete.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"># English: So that there be no false assumptions: I have religiously nothing </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"># To do with the Bible covenant, but they had a fairly large </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"># Spreadsheet file with approx 3500 rows publicly on the net that quite well </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"># Suitable for testing.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">#--</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"># these test cases were developed to run under Linux OS, some commands</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"># (like 'diff') must be changed (or commented out ;-)) if you want to run</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"># the tests under another OS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">#TODO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"># Look at formulas in excel - does not work with date/time</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"># Dump warnings that come from the test to open files</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"># with the wrong spreadsheet class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">#STDERR.reopen &quot;/dev/null&quot;,&quot;w&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">require File.dirname(__FILE__) + '/test_helper'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">class TestRoo &lt; Test::Unit::TestCase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  OPENOFFICE   = true 	# do OpenOffice-Spreadsheet Tests? (.ods files)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  EXCEL        = true  	# do Excel Tests? (.xls files)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  GOOGLE       = false 	# do Google-Spreadsheet Tests?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  EXCELX       = true  	# do Excelx Tests? (.xlsx files)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  LIBREOFFICE  = true  	# do LibreOffice tests? (.ods files)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  CSV          = true  	# do CSV tests? (.csv files)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  FORMATS = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    excel:        EXCEL,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    excelx:       EXCELX,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    openoffice:   OPENOFFICE,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    google:       GOOGLE,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    libreoffice:  LIBREOFFICE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  ONLINE   = false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  LONG_RUN = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def fixture_filename(name, format)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    case format</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    when :excel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">      &quot;#{name}.xls&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    when :excelx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">      &quot;#{name}.xlsx&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    when :openoffice, :libreoffice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">      &quot;#{name}.ods&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    when :google</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">      key_of(name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  # Call a block of code for each spreadsheet type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  # and yield a reference to the roo object</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def with_each_spreadsheet(options)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    if options[:format]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">      options[:format] = Array(options[:format])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">      invalid_formats  = options[:format] - FORMATS.keys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">      if !invalid_formats.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">        raise &quot;invalid spreadsheet types: #{invalid_formats.join(', ')}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">      options[:format] = FORMATS.keys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    options[:format].each do |format|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">        if FORMATS[format]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">          filename = fixture_filename(options[:name], format)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">          pathname = File.join(TESTDIR, filename)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">          yield Roo::Spreadsheet.open(pathname)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">      rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">        raise e, &quot;#{e.message} for #{format}&quot;, e.backtrace</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">### Tests Start Here ###</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  ##</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">  # Using Date.strptime so check that it's using the method</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  # with the value set in date_format</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_date</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1', :format=&gt;:google) do |oo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      # should default to  DDMMYYYY</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">      assert  oo.date?(&quot;21/11/1962&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">      assert !oo.date?(&quot;11/21/1962&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">      oo.date_format = '%m/%d/%Y'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">      assert !oo.date?(&quot;21/11/1962&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">      assert  oo.date?(&quot;11/21/1962&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">      oo.date_format = '%Y-%m-%d'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">      assert( oo.date?(&quot;1962-11-21&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">      assert(!oo.date?(&quot;1962-21-11&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="111">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_sheets_csv</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">    if CSV</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">      oo = Roo::CSV.new(File.join(TESTDIR,'numbers1.csv'))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">      assert_equal [&quot;default&quot;], oo.sheets</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">      assert_raise(RangeError) { oo.default_sheet = &quot;no_sheet&quot; }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">      assert_raise(TypeError)  { oo.default_sheet = [1,2,3] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">      oo.sheets.each { |sh|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">        oo.default_sheet = sh</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">        assert_equal sh, oo.default_sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_sheets</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">      assert_equal [&quot;Tabelle1&quot;,&quot;Name of Sheet 2&quot;,&quot;Sheet3&quot;,&quot;Sheet4&quot;,&quot;Sheet5&quot;], oo.sheets</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">      assert_raise(RangeError) { oo.default_sheet = &quot;no_sheet&quot; }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">      assert_raise(TypeError)  { oo.default_sheet = [1,2,3] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">      oo.sheets.each { |sh|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">        oo.default_sheet = sh</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="131">
          
          
          <code class="ruby">        assert_equal sh, oo.default_sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="136">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_cells</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">      # warum ist Auswaehlen erstes sheet hier nicht</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">      # mehr drin?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">      assert_equal 1, oo.cell(1,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">      assert_equal 2, oo.cell(1,2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">      assert_equal 3, oo.cell(1,3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">      assert_equal 4, oo.cell(1,4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">      assert_equal 5, oo.cell(2,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">      assert_equal 6, oo.cell(2,2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">      assert_equal 7, oo.cell(2,3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="148">
          
          
          <code class="ruby">      assert_equal 8, oo.cell(2,4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="149">
          
          
          <code class="ruby">      assert_equal 9, oo.cell(2,5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="150">
          
          
          <code class="ruby">      assert_equal &quot;test&quot;, oo.cell(2,6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">      assert_equal :string, oo.celltype(2,6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="152">
          
          
          <code class="ruby">      assert_equal 11, oo.cell(2,7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="153">
          
          
          <code class="ruby">      unless oo.kind_of? Roo::CSV</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">        assert_equal :float, oo.celltype(2,7)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="156">
          
          
          <code class="ruby">      assert_equal 10, oo.cell(4,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="157">
          
          
          <code class="ruby">      assert_equal 11, oo.cell(4,2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">      assert_equal 12, oo.cell(4,3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">      assert_equal 13, oo.cell(4,4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">      assert_equal 14, oo.cell(4,5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">      assert_equal 10, oo.cell(4,'A')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">      assert_equal 11, oo.cell(4,'B')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">      assert_equal 12, oo.cell(4,'C')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="164">
          
          
          <code class="ruby">      assert_equal 13, oo.cell(4,'D')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">      assert_equal 14, oo.cell(4,'E')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">      unless oo.kind_of? Roo::CSV</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">        assert_equal :date, oo.celltype(5,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">        assert_equal Date.new(1961,11,21), oo.cell(5,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">        assert_equal &quot;1961-11-21&quot;, oo.cell(5,1).to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_celltype</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="175">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="176">
          
          
          <code class="ruby">      assert_equal :string, oo.celltype(2,6)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="180">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_cell_address</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="181">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="182">
          
          
          <code class="ruby">      assert_equal &quot;tata&quot;, oo.cell(6,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">      assert_equal &quot;tata&quot;, oo.cell(6,'A')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">      assert_equal &quot;tata&quot;, oo.cell('A',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="185">
          
          
          <code class="ruby">      assert_equal &quot;tata&quot;, oo.cell(6,'a')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="186">
          
          
          <code class="ruby">      assert_equal &quot;tata&quot;, oo.cell('a',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="187">
          
          
          <code class="ruby">      assert_raise(ArgumentError) { assert_equal &quot;tata&quot;, oo.cell('a','f') }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="188">
          
          
          <code class="ruby">      assert_raise(ArgumentError) { assert_equal &quot;tata&quot;, oo.cell('f','a') }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">      assert_equal &quot;thisisc8&quot;, oo.cell(8,3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="190">
          
          
          <code class="ruby">      assert_equal &quot;thisisc8&quot;, oo.cell(8,'C')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">      assert_equal &quot;thisisc8&quot;, oo.cell('C',8)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="192">
          
          
          <code class="ruby">      assert_equal &quot;thisisc8&quot;, oo.cell(8,'c')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">      assert_equal &quot;thisisc8&quot;, oo.cell('c',8)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="194">
          
          
          <code class="ruby">      assert_equal &quot;thisisd9&quot;, oo.cell('d',9)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="195">
          
          
          <code class="ruby">      assert_equal &quot;thisisa11&quot;, oo.cell('a',11)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="199">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_office_version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="200">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1', :format=&gt;:openoffice) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="201">
          
          
          <code class="ruby">      assert_equal &quot;1.0&quot;, oo.officeversion</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="205">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_libre_office</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">	  if LIBREOFFICE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="207">
          
          
          <code class="ruby">      oo = Roo::LibreOffice.new(File.join(TESTDIR, &quot;numbers1.ods&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="208">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">      assert_equal 41, oo.cell('a',12)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">	  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="213">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_sheetname</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="214">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Name of Sheet 2&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="216">
          
          
          <code class="ruby">      assert_equal 'I am sheet 2', oo.cell('C',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">      assert_raise(RangeError) { oo.default_sheet = &quot;non existing sheet name&quot; }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">      assert_raise(RangeError) { oo.default_sheet = &quot;non existing sheet name&quot; }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="219">
          
          
          <code class="ruby">      assert_raise(RangeError) { oo.cell('C',5,&quot;non existing sheet name&quot;)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="220">
          
          
          <code class="ruby">      assert_raise(RangeError) { oo.celltype('C',5,&quot;non existing sheet name&quot;)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="221">
          
          
          <code class="ruby">      assert_raise(RangeError) { oo.empty?('C',5,&quot;non existing sheet name&quot;)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="222">
          
          
          <code class="ruby">      if oo.class == Roo::Excel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="223">
          
          
          <code class="ruby">        assert_raise(NotImplementedError) { oo.formula?('C',5,&quot;non existing sheet name&quot;)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="224">
          
          
          <code class="ruby">        assert_raise(NotImplementedError) { oo.formula('C',5,&quot;non existing sheet name&quot;)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="226">
          
          
          <code class="ruby">        assert_raise(RangeError) { oo.formula?('C',5,&quot;non existing sheet name&quot;)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="227">
          
          
          <code class="ruby">        assert_raise(RangeError) { oo.formula('C',5,&quot;non existing sheet name&quot;)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="228">
          
          
          <code class="ruby">        assert_raise(RangeError) { oo.set('C',5,42,&quot;non existing sheet name&quot;)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="229">
          
          
          <code class="ruby">        assert_raise(RangeError) { oo.formulas(&quot;non existing sheet name&quot;)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="231">
          
          
          <code class="ruby">      assert_raise(RangeError) { oo.to_yaml({},1,1,1,1,&quot;non existing sheet name&quot;)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="235">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_argument_error</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="237">
          
          
          <code class="ruby">      assert_nothing_raised(ArgumentError) {  oo.default_sheet = &quot;Tabelle1&quot; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="241">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_contiguous_cells</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="242">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1', :format=&gt;:openoffice) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="243">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Sheet4&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="244">
          
          
          <code class="ruby">      assert_equal Date.new(2007,06,16), oo.cell('a',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">      assert_equal 10, oo.cell('b',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="246">
          
          
          <code class="ruby">      assert_equal 10, oo.cell('c',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="247">
          
          
          <code class="ruby">      assert_equal 10, oo.cell('d',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="248">
          
          
          <code class="ruby">      assert_equal 10, oo.cell('e',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="252">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_italo_ve</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="253">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Sheet5&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">      assert_equal 1, oo.cell('A',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="256">
          
          
          <code class="ruby">      assert_equal 5, oo.cell('b',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="257">
          
          
          <code class="ruby">      assert_equal 5, oo.cell('c',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">      assert_equal 2, oo.cell('a',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">      assert_equal 3, oo.cell('a',3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="263">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_italo_table</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="264">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'simple_spreadsheet_from_italo', :format=&gt;[:openoffice, :excel]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="265">
          
          
          <code class="ruby">      assert_equal  '1', oo.cell('A',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">      assert_equal  '1', oo.cell('B',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="267">
          
          
          <code class="ruby">      assert_equal  '1', oo.cell('C',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">      assert_equal  1, oo.cell('A',2).to_i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">      assert_equal  2, oo.cell('B',2).to_i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="270">
          
          
          <code class="ruby">      assert_equal  1, oo.cell('C',2).to_i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="271">
          
          
          <code class="ruby">      assert_equal  1, oo.cell('A',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="272">
          
          
          <code class="ruby">      assert_equal  3, oo.cell('B',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="273">
          
          
          <code class="ruby">      assert_equal  1, oo.cell('C',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="274">
          
          
          <code class="ruby">      assert_equal  'A', oo.cell('A',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="275">
          
          
          <code class="ruby">      assert_equal  'A', oo.cell('B',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">      assert_equal  'A', oo.cell('C',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="277">
          
          
          <code class="ruby">      assert_equal  0.01, oo.cell('A',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="278">
          
          
          <code class="ruby">      assert_equal  0.01, oo.cell('B',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">      assert_equal  0.01, oo.cell('C',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="280">
          
          
          <code class="ruby">      assert_equal 0.03, oo.cell('a',5)+oo.cell('b',5)+oo.cell('c',5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby">      # Cells values in row 1:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="283">
          
          
          <code class="ruby">      assert_equal &quot;1:string&quot;, oo.cell(1, 1)+&quot;:&quot;+oo.celltype(1, 1).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="284">
          
          
          <code class="ruby">      assert_equal &quot;1:string&quot;,oo.cell(1, 2)+&quot;:&quot;+oo.celltype(1, 2).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="285">
          
          
          <code class="ruby">      assert_equal &quot;1:string&quot;,oo.cell(1, 3)+&quot;:&quot;+oo.celltype(1, 3).to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">      # Cells values in row 2:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">      assert_equal &quot;1:string&quot;,oo.cell(2, 1)+&quot;:&quot;+oo.celltype(2, 1).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="289">
          
          
          <code class="ruby">      assert_equal &quot;2:string&quot;,oo.cell(2, 2)+&quot;:&quot;+oo.celltype(2, 2).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">      assert_equal &quot;1:string&quot;,oo.cell(2, 3)+&quot;:&quot;+oo.celltype(2, 3).to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">      # Cells values in row 3:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">      assert_equal &quot;1.0:float&quot;,oo.cell(3, 1).to_s+&quot;:&quot;+oo.celltype(3, 1).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="294">
          
          
          <code class="ruby">      assert_equal &quot;3.0:float&quot;,oo.cell(3, 2).to_s+&quot;:&quot;+oo.celltype(3, 2).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="295">
          
          
          <code class="ruby">      assert_equal &quot;1.0:float&quot;,oo.cell(3, 3).to_s+&quot;:&quot;+oo.celltype(3, 3).to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">      # Cells values in row 4:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="298">
          
          
          <code class="ruby">      assert_equal &quot;A:string&quot;,oo.cell(4, 1)+&quot;:&quot;+oo.celltype(4, 1).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">      assert_equal &quot;A:string&quot;,oo.cell(4, 2)+&quot;:&quot;+oo.celltype(4, 2).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="300">
          
          
          <code class="ruby">      assert_equal &quot;A:string&quot;,oo.cell(4, 3)+&quot;:&quot;+oo.celltype(4, 3).to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">      # Cells values in row 5:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="303">
          
          
          <code class="ruby">      if oo.class == Roo::OpenOffice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="304">
          
          
          <code class="ruby">        assert_equal &quot;0.01:percentage&quot;,oo.cell(5, 1).to_s+&quot;:&quot;+oo.celltype(5, 1).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">        assert_equal &quot;0.01:percentage&quot;,oo.cell(5, 2).to_s+&quot;:&quot;+oo.celltype(5, 2).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">        assert_equal &quot;0.01:percentage&quot;,oo.cell(5, 3).to_s+&quot;:&quot;+oo.celltype(5, 3).to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="308">
          
          
          <code class="ruby">        assert_equal &quot;0.01:float&quot;,oo.cell(5, 1).to_s+&quot;:&quot;+oo.celltype(5, 1).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="309">
          
          
          <code class="ruby">        assert_equal &quot;0.01:float&quot;,oo.cell(5, 2).to_s+&quot;:&quot;+oo.celltype(5, 2).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">        assert_equal &quot;0.01:float&quot;,oo.cell(5, 3).to_s+&quot;:&quot;+oo.celltype(5, 3).to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="311">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="315">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_formula_openoffice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'formula', :format=&gt;:openoffice) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">      assert_equal 1, oo.cell('A',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">      assert_equal 2, oo.cell('A',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="319">
          
          
          <code class="ruby">      assert_equal 3, oo.cell('A',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">      assert_equal 4, oo.cell('A',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">      assert_equal 5, oo.cell('A',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="322">
          
          
          <code class="ruby">      assert_equal 6, oo.cell('A',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="323">
          
          
          <code class="ruby">      assert_equal 21, oo.cell('A',7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="324">
          
          
          <code class="ruby">      assert_equal :formula, oo.celltype('A',7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="325">
          
          
          <code class="ruby">      assert_equal &quot;=[Sheet2.A1]&quot;, oo.formula('C',7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="326">
          
          
          <code class="ruby">      assert_nil oo.formula('A',6)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">      assert_equal [[7, 1, &quot;=SUM([.A1:.A6])&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby">        [7, 2, &quot;=SUM([.$A$1:.B6])&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">        [7, 3, &quot;=[Sheet2.A1]&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby">        [8, 2, &quot;=SUM([.$A$1:.B7])&quot;],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="331">
          
          
          <code class="ruby">      ], oo.formulas(oo.sheets.first)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="333">
          
          
          <code class="ruby">      # setting a cell</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="334">
          
          
          <code class="ruby">      oo.set('A',15, 41)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="335">
          
          
          <code class="ruby">      assert_equal 41, oo.cell('A',15)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="336">
          
          
          <code class="ruby">      oo.set('A',16, &quot;41&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="337">
          
          
          <code class="ruby">      assert_equal &quot;41&quot;, oo.cell('A',16)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">      oo.set('A',17, 42.5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="339">
          
          
          <code class="ruby">      assert_equal 42.5, oo.cell('A',17)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="343">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_formula_google</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'formula', :format=&gt;:google) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="346">
          
          
          <code class="ruby">      assert_equal 1, oo.cell('A',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="347">
          
          
          <code class="ruby">      assert_equal 2, oo.cell('A',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="348">
          
          
          <code class="ruby">      assert_equal 3, oo.cell('A',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="349">
          
          
          <code class="ruby">      assert_equal 4, oo.cell('A',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="350">
          
          
          <code class="ruby">      assert_equal 5, oo.cell('A',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="351">
          
          
          <code class="ruby">      assert_equal 6, oo.cell('A',6)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby">      # assert_equal 21, oo.cell('A',7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">      assert_equal 21.0, oo.cell('A',7) #TODO: better solution Fixnum/Float</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="354">
          
          
          <code class="ruby">      assert_equal :formula, oo.celltype('A',7)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby">      # assert_equal &quot;=[Sheet2.A1]&quot;, oo.formula('C',7)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby">      # !!! different from formulas in OpenOffice</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby">      #was: assert_equal &quot;=sheet2!R[-6]C[-2]&quot;, oo.formula('C',7)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby">      # has Google changed their format of formulas/references to other sheets?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="359">
          
          
          <code class="ruby">      assert_equal &quot;=Sheet2!R[-6]C[-2]&quot;, oo.formula('C',7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="360">
          
          
          <code class="ruby">      assert_nil oo.formula('A',6)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">      # assert_equal [[7, 1, &quot;=SUM([.A1:.A6])&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">      #   [7, 2, &quot;=SUM([.$A$1:.B6])&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">      #   [7, 3, &quot;=[Sheet2.A1]&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby">      #   [8, 2, &quot;=SUM([.$A$1:.B7])&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">      # ], oo.formulas(oo.sheets.first)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby">      # different format than in openoffice spreadsheets:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="367">
          
          
          <code class="ruby">      #was:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby">      # assert_equal [[7, 1, &quot;=SUM(R[-6]C[0]:R[-1]C[0])&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby">      #  [7, 2, &quot;=SUM(R1C1:R[-1]C[0])&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby">      #  [7, 3, &quot;=sheet2!R[-6]C[-2]&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">      #  [8, 2, &quot;=SUM(R1C1:R[-1]C[0])&quot;]],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby">      #  oo.formulas(oo.sheets.first)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby">      assert_equal [[7, 1, &quot;=SUM(R[-6]C:R[-1]C)&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby">        [7, 2, &quot;=SUM(R1C1:R[-1]C)&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">        [7, 3, &quot;=Sheet2!R[-6]C[-2]&quot;],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="376">
          
          
          <code class="ruby">        [8, 2, &quot;=SUM(R1C1:R[-1]C)&quot;]],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="377">
          
          
          <code class="ruby">        oo.formulas(oo.sheets.first)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="378">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="380">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="381">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_formula_excelx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="382">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'formula', :format=&gt;:excelx) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="383">
          
          
          <code class="ruby">      assert_equal 1, oo.cell('A',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="384">
          
          
          <code class="ruby">      assert_equal 2, oo.cell('A',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="385">
          
          
          <code class="ruby">      assert_equal 3, oo.cell('A',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="386">
          
          
          <code class="ruby">      assert_equal 4, oo.cell('A',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="387">
          
          
          <code class="ruby">      assert_equal 5, oo.cell('A',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="388">
          
          
          <code class="ruby">      assert_equal 6, oo.cell('A',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="389">
          
          
          <code class="ruby">      assert_equal 21, oo.cell('A',7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="390">
          
          
          <code class="ruby">      assert_equal :formula, oo.celltype('A',7)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby">      #steht nicht in Datei, oder?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="392">
          
          
          <code class="ruby">      #nein, diesen Bezug habe ich nur in der OpenOffice-Datei</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby">      #assert_equal &quot;=[Sheet2.A1]&quot;, oo.formula('C',7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="394">
          
          
          <code class="ruby">      assert_nil oo.formula('A',6)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby">      # assert_equal [[7, 1, &quot;=SUM([.A1:.A6])&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby">      #  [7, 2, &quot;=SUM([.$A$1:.B6])&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby">      #[7, 3, &quot;=[Sheet2.A1]&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="398">
          
          
          <code class="ruby">      #[8, 2, &quot;=SUM([.$A$1:.B7])&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="399">
          
          
          <code class="ruby">      #], oo.formulas(oo.sheets.first)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="400">
          
          
          <code class="ruby">      assert_equal [[7, 1, 'SUM(A1:A6)'],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="401">
          
          
          <code class="ruby">        [7, 2, 'SUM($A$1:B6)'],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby">        # [7, 3, &quot;=[Sheet2.A1]&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="403">
          
          
          <code class="ruby">        # [8, 2, &quot;=SUM([.$A$1:.B7])&quot;],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="404">
          
          
          <code class="ruby">      ], oo.formulas(oo.sheets.first)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby">      # setting a cell</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="407">
          
          
          <code class="ruby">      oo.set('A',15, 41)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="408">
          
          
          <code class="ruby">      assert_equal 41, oo.cell('A',15)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="409">
          
          
          <code class="ruby">      oo.set('A',16, &quot;41&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="410">
          
          
          <code class="ruby">      assert_equal &quot;41&quot;, oo.cell('A',16)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="411">
          
          
          <code class="ruby">      oo.set('A',17, 42.5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="412">
          
          
          <code class="ruby">      assert_equal 42.5, oo.cell('A',17)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="413">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby">  # Excel can only read the cell's value</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="417">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_formula_excel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="418">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'formula', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="419">
          
          
          <code class="ruby">      assert_equal 21, oo.cell('A',7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="420">
          
          
          <code class="ruby">      assert_equal 21, oo.cell('B',7)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="421">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="422">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="424">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_borders_sheets</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="425">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'borders') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="426">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="427">
          
          
          <code class="ruby">      assert_equal 6, oo.first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="428">
          
          
          <code class="ruby">      assert_equal 11, oo.last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="429">
          
          
          <code class="ruby">      assert_equal 4, oo.first_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="430">
          
          
          <code class="ruby">      assert_equal 8, oo.last_column</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="432">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="433">
          
          
          <code class="ruby">      assert_equal 5, oo.first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="434">
          
          
          <code class="ruby">      assert_equal 10, oo.last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="435">
          
          
          <code class="ruby">      assert_equal 3, oo.first_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="436">
          
          
          <code class="ruby">      assert_equal 7, oo.last_column</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="438">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets[2]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="439">
          
          
          <code class="ruby">      assert_equal 7, oo.first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="440">
          
          
          <code class="ruby">      assert_equal 12, oo.last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="441">
          
          
          <code class="ruby">      assert_equal 5, oo.first_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="442">
          
          
          <code class="ruby">      assert_equal 9, oo.last_column</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="443">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="444">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="445">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="446">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_only_one_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="447">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'only_one_sheet') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="448">
          
          
          <code class="ruby">      assert_equal 42, oo.cell('B',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="449">
          
          
          <code class="ruby">      assert_equal 43, oo.cell('C',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="450">
          
          
          <code class="ruby">      assert_equal 44, oo.cell('D',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="451">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="452">
          
          
          <code class="ruby">      assert_equal 42, oo.cell('B',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="453">
          
          
          <code class="ruby">      assert_equal 43, oo.cell('C',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="454">
          
          
          <code class="ruby">      assert_equal 44, oo.cell('D',4)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="455">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="456">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="457">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="458">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_excel_download_uri_and_zipped</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="459">
          
          
          <code class="ruby">    if EXCEL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="460">
          
          
          <code class="ruby">      if ONLINE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="461">
          
          
          <code class="ruby">        url = 'http://stiny-leonhard.de/bode-v1.xls.zip'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="462">
          
          
          <code class="ruby">        excel = Roo::Excel.new(url, :zip)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="463">
          
          
          <code class="ruby">        excel.default_sheet = excel.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="464">
          
          
          <code class="ruby">        assert_equal 'ist &quot;e&quot; im Nenner von H(s)', excel.cell('b', 5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="465">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="466">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="468">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="469">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_openoffice_download_uri_and_zipped</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="470">
          
          
          <code class="ruby">    if OPENOFFICE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="471">
          
          
          <code class="ruby">      if ONLINE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="472">
          
          
          <code class="ruby">        url = 'http://spazioinwind.libero.it/s2/rata.ods.zip'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="473">
          
          
          <code class="ruby">        sheet = Roo::OpenOffice.new(url, :zip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="474">
          
          
          <code class="ruby">        #has been changed: assert_equal 'ist &quot;e&quot; im Nenner von H(s)', sheet.cell('b', 5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="475">
          
          
          <code class="ruby">        assert_in_delta 0.001, 505.14, sheet.cell('c', 33).to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="476">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="477">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="478">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="479">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="480">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_excel_zipped</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="481">
          
          
          <code class="ruby">    if EXCEL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="482">
          
          
          <code class="ruby">      oo = Roo::Excel.new(File.join(TESTDIR,&quot;bode-v1.xls.zip&quot;), :zip)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="483">
          
          
          <code class="ruby">      assert oo</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="484">
          
          
          <code class="ruby">      assert_equal 'ist &quot;e&quot; im Nenner von H(s)', oo.cell('b', 5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="486">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="487">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="488">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_openoffice_zipped</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="489">
          
          
          <code class="ruby">    if OPENOFFICE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="491">
          
          
          <code class="ruby">        oo = Roo::OpenOffice.new(File.join(TESTDIR,&quot;bode-v1.ods.zip&quot;), :zip)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="492">
          
          
          <code class="ruby">        assert oo</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="493">
          
          
          <code class="ruby">        assert_equal 'ist &quot;e&quot; im Nenner von H(s)', oo.cell('b', 5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="494">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="495">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="496">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="497">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="498">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_ric</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="499">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'ric', :format=&gt;:openoffice) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="500">
          
          
          <code class="ruby">      assert oo.empty?('A',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="501">
          
          
          <code class="ruby">      assert oo.empty?('B',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="502">
          
          
          <code class="ruby">      assert oo.empty?('C',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="503">
          
          
          <code class="ruby">      assert oo.empty?('D',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="504">
          
          
          <code class="ruby">      expected = 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="505">
          
          
          <code class="ruby">      letter = 'e'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="506">
          
          
          <code class="ruby">      while letter &lt;= 'u'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="507">
          
          
          <code class="ruby">        assert_equal expected, oo.cell(letter,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="508">
          
          
          <code class="ruby">        letter.succ!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="509">
          
          
          <code class="ruby">        expected += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="510">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="511">
          
          
          <code class="ruby">      assert_equal 'J', oo.cell('v',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="512">
          
          
          <code class="ruby">      assert_equal 'P', oo.cell('w',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="513">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('x',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="514">
          
          
          <code class="ruby">      assert_equal 'All', oo.cell('y',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="515">
          
          
          <code class="ruby">      assert_equal 0, oo.cell('a',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="516">
          
          
          <code class="ruby">      assert oo.empty?('b',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="517">
          
          
          <code class="ruby">      assert oo.empty?('c',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="518">
          
          
          <code class="ruby">      assert oo.empty?('d',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="519">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('e',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="520">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('f',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="521">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('g',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="522">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('h',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="523">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('i',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="524">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('j',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="525">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('k',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="526">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('l',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="527">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('m',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="528">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('n',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="529">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('o',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="530">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('p',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="531">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('q',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="532">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('r',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="533">
          
          
          <code class="ruby">      assert_equal 'B', oo.cell('s',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="534">
          
          
          <code class="ruby">      assert oo.empty?('t',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="535">
          
          
          <code class="ruby">      assert oo.empty?('u',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="536">
          
          
          <code class="ruby">      assert_equal 0  , oo.cell('v',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="537">
          
          
          <code class="ruby">      assert_equal 0  , oo.cell('w',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="538">
          
          
          <code class="ruby">      assert_equal 15 , oo.cell('x',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="539">
          
          
          <code class="ruby">      assert_equal 15 , oo.cell('y',2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="540">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="541">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="542">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="543">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_mehrteilig</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="544">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'Bibelbund1', :format=&gt;:openoffice) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="545">
          
          
          <code class="ruby">      assert_equal &quot;Tagebuch des Sekret\303\244rs.    Letzte Tagung 15./16.11.75 Schweiz&quot;, oo.cell(45,'A')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="546">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby">    #if EXCELX</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="548">
          
          
          <code class="ruby">    #    #Datei gibt es noch nicht</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="549">
          
          
          <code class="ruby">    #    oo = Roo::Excelx.new(File.join(TESTDIR,&quot;Bibelbund1.xlsx&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="550">
          
          
          <code class="ruby">    #    oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="551">
          
          
          <code class="ruby">    #    assert_equal &quot;Tagebuch des Sekret\303\244rs.    Letzte Tagung 15./16.11.75 Schweiz&quot;, oo.cell(45,'A')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="552">
          
          
          <code class="ruby">    #end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="553">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="554">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="555">
          
          
          <code class="ruby">  # &quot;/tmp/xxxx&quot; darf man unter Windows nicht verwenden, weil das nicht erkannt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="556">
          
          
          <code class="ruby">  # wird.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="557">
          
          
          <code class="ruby">  # Besser: Methode um temporaeres Dir. portabel zu bestimmen</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="558">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_huge_document_to_csv</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="559">
          
          
          <code class="ruby">    if LONG_RUN</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="560">
          
          
          <code class="ruby">      with_each_spreadsheet(:name=&gt;'Bibelbund', :format=&gt;[</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="561">
          
          
          <code class="ruby">        :openoffice,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="562">
          
          
          <code class="ruby">        :excel,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="563">
          
          
          <code class="ruby">        :excelx</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="564">
          
          
          <code class="ruby">        # Google hier nicht, weil Google-Spreadsheets nicht so gross werden</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="565">
          
          
          <code class="ruby">        # duerfen</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="566">
          
          
          <code class="ruby">      ]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="567">
          
          
          <code class="ruby">        Dir.mktmpdir do |tempdir|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="568">
          
          
          <code class="ruby">          assert_equal &quot;Tagebuch des Sekret\303\244rs.    Letzte Tagung 15./16.11.75 Schweiz&quot;, oo.cell(45,'A')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="569">
          
          
          <code class="ruby">          assert_equal &quot;Tagebuch des Sekret\303\244rs.  Nachrichten aus Chile&quot;, oo.cell(46,'A')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="570">
          
          
          <code class="ruby">          assert_equal &quot;Tagebuch aus Chile  Juli 1977&quot;, oo.cell(55,'A')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="571">
          
          
          <code class="ruby">          assert oo.to_csv(File.join(tempdir,&quot;Bibelbund.csv&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="572">
          
          
          <code class="ruby">          assert File.exists?(File.join(tempdir,&quot;Bibelbund.csv&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="573">
          
          
          <code class="ruby">          assert_equal &quot;&quot;, file_diff(File.join(TESTDIR, &quot;Bibelbund.csv&quot;), File.join(tempdir,&quot;Bibelbund.csv&quot;)),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="574">
          
          
          <code class="ruby">            &quot;error in class #{oo.class}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="575">
          
          
          <code class="ruby">          #end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="576">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="577">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="578">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="579">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="580">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="581">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_quotes_excelx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="582">
          
          
          <code class="ruby">	  if LONG_RUN</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="583">
          
          
          <code class="ruby">      with_each_spreadsheet(:name=&gt;'Bibelbund', :format=&gt;[:openoffice,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="584">
          
          
          <code class="ruby">          :excel,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="585">
          
          
          <code class="ruby">          :excelx]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="586">
          
          
          <code class="ruby">        oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="587">
          
          
          <code class="ruby">        assert_equal 'Einflüsse der neuen Theologie in &quot;de gereformeerde Kerken van Nederland&quot;',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="588">
          
          
          <code class="ruby">          oo.cell('a',76)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="589">
          
          
          <code class="ruby">        oo.to_csv(&quot;csv#{$$}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="590">
          
          
          <code class="ruby">        assert_equal 'Einflüsse der neuen Theologie in &quot;de gereformeerde Kerken van Nederland&quot;',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="591">
          
          
          <code class="ruby">          oo.cell('a',78)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="592">
          
          
          <code class="ruby">        File.delete_if_exist(&quot;csv#{$$}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="593">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="594">
          
          
          <code class="ruby">	  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="595">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="596">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="597">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_mehrere_datum</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="598">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="599">
          
          
          <code class="ruby">      oo.default_sheet = 'Sheet5'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="600">
          
          
          <code class="ruby">      assert_equal :date, oo.celltype('A',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="601">
          
          
          <code class="ruby">      assert_equal :date, oo.celltype('B',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="602">
          
          
          <code class="ruby">      assert_equal :date, oo.celltype('C',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="603">
          
          
          <code class="ruby">      assert_equal :date, oo.celltype('D',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="604">
          
          
          <code class="ruby">      assert_equal :date, oo.celltype('E',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="605">
          
          
          <code class="ruby">      assert_equal Date.new(2007,11,21), oo.cell('A',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="606">
          
          
          <code class="ruby">      assert_equal Date.new(2007,11,21), oo.cell('B',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="607">
          
          
          <code class="ruby">      assert_equal Date.new(2007,11,21), oo.cell('C',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="608">
          
          
          <code class="ruby">      assert_equal Date.new(2007,11,21), oo.cell('D',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="609">
          
          
          <code class="ruby">      assert_equal Date.new(2007,11,21), oo.cell('E',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="610">
          
          
          <code class="ruby">      assert_equal :float, oo.celltype('A',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="611">
          
          
          <code class="ruby">      assert_equal :float, oo.celltype('B',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="612">
          
          
          <code class="ruby">      assert_equal :float, oo.celltype('C',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="613">
          
          
          <code class="ruby">      assert_equal :float, oo.celltype('D',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="614">
          
          
          <code class="ruby">      assert_equal :float, oo.celltype('E',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="615">
          
          
          <code class="ruby">      assert_equal 42, oo.cell('A',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="616">
          
          
          <code class="ruby">      assert_equal 42, oo.cell('B',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="617">
          
          
          <code class="ruby">      assert_equal 42, oo.cell('C',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="618">
          
          
          <code class="ruby">      assert_equal 42, oo.cell('D',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="619">
          
          
          <code class="ruby">      assert_equal 42, oo.cell('E',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="620">
          
          
          <code class="ruby">      assert_equal :string, oo.celltype('A',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="621">
          
          
          <code class="ruby">      assert_equal :string, oo.celltype('B',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="622">
          
          
          <code class="ruby">      assert_equal :string, oo.celltype('C',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="623">
          
          
          <code class="ruby">      assert_equal :string, oo.celltype('D',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="624">
          
          
          <code class="ruby">      assert_equal :string, oo.celltype('E',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="625">
          
          
          <code class="ruby">      assert_equal &quot;ABC&quot;, oo.cell('A',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="626">
          
          
          <code class="ruby">      assert_equal &quot;ABC&quot;, oo.cell('B',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="627">
          
          
          <code class="ruby">      assert_equal &quot;ABC&quot;, oo.cell('C',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="628">
          
          
          <code class="ruby">      assert_equal &quot;ABC&quot;, oo.cell('D',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="629">
          
          
          <code class="ruby">      assert_equal &quot;ABC&quot;, oo.cell('E',6)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="630">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="631">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="633">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_multiple_sheets</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="634">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="635">
          
          
          <code class="ruby">      2.times do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="636">
          
          
          <code class="ruby">        oo.default_sheet = &quot;Tabelle1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="637">
          
          
          <code class="ruby">        assert_equal 1, oo.cell(1,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="638">
          
          
          <code class="ruby">        assert_equal 1, oo.cell(1,1,&quot;Tabelle1&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="639">
          
          
          <code class="ruby">        assert_equal &quot;I am sheet 2&quot;, oo.cell('C',5,&quot;Name of Sheet 2&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="640">
          
          
          <code class="ruby">        sheetname = 'Sheet5'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="641">
          
          
          <code class="ruby">        assert_equal :date, oo.celltype('A',4,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="642">
          
          
          <code class="ruby">        assert_equal :date, oo.celltype('B',4,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="643">
          
          
          <code class="ruby">        assert_equal :date, oo.celltype('C',4,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="644">
          
          
          <code class="ruby">        assert_equal :date, oo.celltype('D',4,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="645">
          
          
          <code class="ruby">        assert_equal :date, oo.celltype('E',4,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="646">
          
          
          <code class="ruby">        assert_equal Date.new(2007,11,21), oo.cell('A',4,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="647">
          
          
          <code class="ruby">        assert_equal Date.new(2007,11,21), oo.cell('B',4,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="648">
          
          
          <code class="ruby">        assert_equal Date.new(2007,11,21), oo.cell('C',4,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="649">
          
          
          <code class="ruby">        assert_equal Date.new(2007,11,21), oo.cell('D',4,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="650">
          
          
          <code class="ruby">        assert_equal Date.new(2007,11,21), oo.cell('E',4,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="651">
          
          
          <code class="ruby">        assert_equal :float, oo.celltype('A',5,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="652">
          
          
          <code class="ruby">        assert_equal :float, oo.celltype('B',5,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="653">
          
          
          <code class="ruby">        assert_equal :float, oo.celltype('C',5,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="654">
          
          
          <code class="ruby">        assert_equal :float, oo.celltype('D',5,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="655">
          
          
          <code class="ruby">        assert_equal :float, oo.celltype('E',5,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="656">
          
          
          <code class="ruby">        assert_equal 42, oo.cell('A',5,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="657">
          
          
          <code class="ruby">        assert_equal 42, oo.cell('B',5,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="658">
          
          
          <code class="ruby">        assert_equal 42, oo.cell('C',5,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="659">
          
          
          <code class="ruby">        assert_equal 42, oo.cell('D',5,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="660">
          
          
          <code class="ruby">        assert_equal 42, oo.cell('E',5,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="661">
          
          
          <code class="ruby">        assert_equal :string, oo.celltype('A',6,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="662">
          
          
          <code class="ruby">        assert_equal :string, oo.celltype('B',6,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="663">
          
          
          <code class="ruby">        assert_equal :string, oo.celltype('C',6,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="664">
          
          
          <code class="ruby">        assert_equal :string, oo.celltype('D',6,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="665">
          
          
          <code class="ruby">        assert_equal :string, oo.celltype('E',6,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="666">
          
          
          <code class="ruby">        assert_equal &quot;ABC&quot;, oo.cell('A',6,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="667">
          
          
          <code class="ruby">        assert_equal &quot;ABC&quot;, oo.cell('B',6,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="668">
          
          
          <code class="ruby">        assert_equal &quot;ABC&quot;, oo.cell('C',6,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="669">
          
          
          <code class="ruby">        assert_equal &quot;ABC&quot;, oo.cell('D',6,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="670">
          
          
          <code class="ruby">        assert_equal &quot;ABC&quot;, oo.cell('E',6,sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="671">
          
          
          <code class="ruby">        oo.reload</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="672">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="673">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="674">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="675">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="676">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="677">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_empty_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="678">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'formula', :format=&gt;[:openoffice, :excelx]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="679">
          
          
          <code class="ruby">      oo.default_sheet = 'Sheet3' # is an empty sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="680">
          
          
          <code class="ruby">      Dir.mktmpdir do |tempdir|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="681">
          
          
          <code class="ruby">        assert_nothing_raised() {  oo.to_csv(File.join(tempdir,&quot;emptysheet.csv&quot;))  }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="682">
          
          
          <code class="ruby">        assert_equal &quot;&quot;, `cat #{File.join(tempdir,&quot;emptysheet.csv&quot;)}`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="683">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="684">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="685">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="686">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="687">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_find_by_row_huge_document</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="688">
          
          
          <code class="ruby">    if LONG_RUN</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="689">
          
          
          <code class="ruby">      with_each_spreadsheet(:name=&gt;'Bibelbund', :format=&gt;[:openoffice,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="690">
          
          
          <code class="ruby">          :excel,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="691">
          
          
          <code class="ruby">          :excelx]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="692">
          
          
          <code class="ruby">        oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="693">
          
          
          <code class="ruby">        rec = oo.find 20</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="694">
          
          
          <code class="ruby">        assert rec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="695">
          
          
          <code class="ruby">        # assert_equal &quot;Brief aus dem Sekretariat&quot;, rec[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="696">
          
          
          <code class="ruby">        #p rec</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="697">
          
          
          <code class="ruby">        assert_equal &quot;Brief aus dem Sekretariat&quot;, rec[0]['TITEL']</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="698">
          
          
          <code class="ruby">        rec = oo.find 22</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="699">
          
          
          <code class="ruby">        assert rec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="700">
          
          
          <code class="ruby">        # assert_equal &quot;Brief aus dem Skretariat. Tagung in Amberg/Opf.&quot;,rec[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="701">
          
          
          <code class="ruby">        assert_equal &quot;Brief aus dem Skretariat. Tagung in Amberg/Opf.&quot;,rec[0]['TITEL']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="702">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="703">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="704">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="705">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="706">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_find_by_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="707">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="708">
          
          
          <code class="ruby">      oo.header_line = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="709">
          
          
          <code class="ruby">      rec = oo.find 16</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="710">
          
          
          <code class="ruby">      assert rec</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="711">
          
          
          <code class="ruby">      assert_nil oo.header_line</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="712">
          
          
          <code class="ruby">      # keine Headerlines in diesem Beispiel definiert</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="713">
          
          
          <code class="ruby">      assert_equal &quot;einundvierzig&quot;, rec[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="714">
          
          
          <code class="ruby">      #assert_equal false, rec</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="715">
          
          
          <code class="ruby">      rec = oo.find 15</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="716">
          
          
          <code class="ruby">      assert rec</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="717">
          
          
          <code class="ruby">      assert_equal 41,rec[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="718">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="719">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="720">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="721">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_find_by_row_if_header_line_is_not_nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="722">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="723">
          
          
          <code class="ruby">      oo.header_line = 2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="724">
          
          
          <code class="ruby">      assert_not_nil oo.header_line</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="725">
          
          
          <code class="ruby">      rec = oo.find 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="726">
          
          
          <code class="ruby">      assert rec</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="727">
          
          
          <code class="ruby">      assert_equal 5, rec[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="728">
          
          
          <code class="ruby">      assert_equal 6, rec[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="729">
          
          
          <code class="ruby">      rec = oo.find 15</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="730">
          
          
          <code class="ruby">      assert rec</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="731">
          
          
          <code class="ruby">      assert_equal &quot;einundvierzig&quot;, rec[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="732">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="733">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="734">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="735">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_find_by_conditions</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="736">
          
          
          <code class="ruby">    if LONG_RUN</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="737">
          
          
          <code class="ruby">      with_each_spreadsheet(:name=&gt;'Bibelbund', :format=&gt;[:openoffice,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="738">
          
          
          <code class="ruby">          :excel,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="739">
          
          
          <code class="ruby">          :excelx]) do |oo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="740">
          
          
          <code class="ruby">        #-----------------------------------------------------------------</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="741">
          
          
          <code class="ruby">        zeilen = oo.find(:all, :conditions =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="742">
          
          
          <code class="ruby">            'TITEL' =&gt; 'Brief aus dem Sekretariat'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="743">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="744">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="745">
          
          
          <code class="ruby">        assert_equal 2, zeilen.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="746">
          
          
          <code class="ruby">        assert_equal [{&quot;VERFASSER&quot;=&gt;&quot;Almassy, Annelene von&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="747">
          
          
          <code class="ruby">            &quot;INTERNET&quot;=&gt;nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="748">
          
          
          <code class="ruby">            &quot;SEITE&quot;=&gt;316.0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="749">
          
          
          <code class="ruby">            &quot;KENNUNG&quot;=&gt;&quot;Aus dem Bibelbund&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="750">
          
          
          <code class="ruby">            &quot;OBJEKT&quot;=&gt;&quot;Bibel+Gem&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="751">
          
          
          <code class="ruby">            &quot;PC&quot;=&gt;&quot;#C:\\Bibelbund\\reprint\\BuG1982-3.pdf#&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="752">
          
          
          <code class="ruby">            &quot;NUMMER&quot;=&gt;&quot;1982-3&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="753">
          
          
          <code class="ruby">            &quot;TITEL&quot;=&gt;&quot;Brief aus dem Sekretariat&quot;},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="754">
          
          
          <code class="ruby">          {&quot;VERFASSER&quot;=&gt;&quot;Almassy, Annelene von&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="755">
          
          
          <code class="ruby">            &quot;INTERNET&quot;=&gt;nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="756">
          
          
          <code class="ruby">            &quot;SEITE&quot;=&gt;222.0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="757">
          
          
          <code class="ruby">            &quot;KENNUNG&quot;=&gt;&quot;Aus dem Bibelbund&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="758">
          
          
          <code class="ruby">            &quot;OBJEKT&quot;=&gt;&quot;Bibel+Gem&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="759">
          
          
          <code class="ruby">            &quot;PC&quot;=&gt;&quot;#C:\\Bibelbund\\reprint\\BuG1983-2.pdf#&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="760">
          
          
          <code class="ruby">            &quot;NUMMER&quot;=&gt;&quot;1983-2&quot;,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="761">
          
          
          <code class="ruby">            &quot;TITEL&quot;=&gt;&quot;Brief aus dem Sekretariat&quot;}] , zeilen</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="762">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="763">
          
          
          <code class="ruby">        #----------------------------------------------------------</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="764">
          
          
          <code class="ruby">        zeilen = oo.find(:all,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="765">
          
          
          <code class="ruby">          :conditions =&gt; { 'VERFASSER' =&gt; 'Almassy, Annelene von' }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="766">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="767">
          
          
          <code class="ruby">        assert_equal 13, zeilen.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="768">
          
          
          <code class="ruby">        #----------------------------------------------------------</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="769">
          
          
          <code class="ruby">        zeilen = oo.find(:all, :conditions =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="770">
          
          
          <code class="ruby">            'TITEL' =&gt; 'Brief aus dem Sekretariat',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="771">
          
          
          <code class="ruby">            'VERFASSER' =&gt; 'Almassy, Annelene von',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="772">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="773">
          
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="774">
          
          
          <code class="ruby">        assert_equal 2, zeilen.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="775">
          
          
          <code class="ruby">        assert_equal [{&quot;VERFASSER&quot;=&gt;&quot;Almassy, Annelene von&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="776">
          
          
          <code class="ruby">            &quot;INTERNET&quot;=&gt;nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="777">
          
          
          <code class="ruby">            &quot;SEITE&quot;=&gt;316.0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="778">
          
          
          <code class="ruby">            &quot;KENNUNG&quot;=&gt;&quot;Aus dem Bibelbund&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="779">
          
          
          <code class="ruby">            &quot;OBJEKT&quot;=&gt;&quot;Bibel+Gem&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="780">
          
          
          <code class="ruby">            &quot;PC&quot;=&gt;&quot;#C:\\Bibelbund\\reprint\\BuG1982-3.pdf#&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="781">
          
          
          <code class="ruby">            &quot;NUMMER&quot;=&gt;&quot;1982-3&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="782">
          
          
          <code class="ruby">            &quot;TITEL&quot;=&gt;&quot;Brief aus dem Sekretariat&quot;},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="783">
          
          
          <code class="ruby">          {&quot;VERFASSER&quot;=&gt;&quot;Almassy, Annelene von&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="784">
          
          
          <code class="ruby">            &quot;INTERNET&quot;=&gt;nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="785">
          
          
          <code class="ruby">            &quot;SEITE&quot;=&gt;222.0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="786">
          
          
          <code class="ruby">            &quot;KENNUNG&quot;=&gt;&quot;Aus dem Bibelbund&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="787">
          
          
          <code class="ruby">            &quot;OBJEKT&quot;=&gt;&quot;Bibel+Gem&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="788">
          
          
          <code class="ruby">            &quot;PC&quot;=&gt;&quot;#C:\\Bibelbund\\reprint\\BuG1983-2.pdf#&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="789">
          
          
          <code class="ruby">            &quot;NUMMER&quot;=&gt;&quot;1983-2&quot;,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="790">
          
          
          <code class="ruby">            &quot;TITEL&quot;=&gt;&quot;Brief aus dem Sekretariat&quot;}] , zeilen</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="791">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="792">
          
          
          <code class="ruby">        # Result as an array</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="793">
          
          
          <code class="ruby">        zeilen = oo.find(:all,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="794">
          
          
          <code class="ruby">          :conditions =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="795">
          
          
          <code class="ruby">            'TITEL' =&gt; 'Brief aus dem Sekretariat',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="796">
          
          
          <code class="ruby">            'VERFASSER' =&gt; 'Almassy, Annelene von',</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="797">
          
          
          <code class="ruby">          }, :array =&gt; true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="798">
          
          
          <code class="ruby">        assert_equal 2, zeilen.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="799">
          
          
          <code class="ruby">        assert_equal [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="800">
          
          
          <code class="ruby">          [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="801">
          
          
          <code class="ruby">            &quot;Brief aus dem Sekretariat&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="802">
          
          
          <code class="ruby">            &quot;Almassy, Annelene von&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="803">
          
          
          <code class="ruby">            &quot;Bibel+Gem&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="804">
          
          
          <code class="ruby">            &quot;1982-3&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="805">
          
          
          <code class="ruby">            316.0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="806">
          
          
          <code class="ruby">            nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="807">
          
          
          <code class="ruby">            &quot;#C:\\Bibelbund\\reprint\\BuG1982-3.pdf#&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="808">
          
          
          <code class="ruby">            &quot;Aus dem Bibelbund&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="809">
          
          
          <code class="ruby">          ],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="810">
          
          
          <code class="ruby">          [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="811">
          
          
          <code class="ruby">            &quot;Brief aus dem Sekretariat&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="812">
          
          
          <code class="ruby">            &quot;Almassy, Annelene von&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="813">
          
          
          <code class="ruby">            &quot;Bibel+Gem&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="814">
          
          
          <code class="ruby">            &quot;1983-2&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="815">
          
          
          <code class="ruby">            222.0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="816">
          
          
          <code class="ruby">            nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="817">
          
          
          <code class="ruby">            &quot;#C:\\Bibelbund\\reprint\\BuG1983-2.pdf#&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="818">
          
          
          <code class="ruby">            &quot;Aus dem Bibelbund&quot;,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="819">
          
          
          <code class="ruby">          ]] , zeilen</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="820">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="821">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="822">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="823">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="824">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="825">
          
          
          <code class="ruby">  #TODO: temporaerer Test</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="826">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_seiten_als_date</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="827">
          
          
          <code class="ruby">	  if LONG_RUN</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="828">
          
          
          <code class="ruby">      with_each_spreadsheet(:name=&gt;'Bibelbund', :format=&gt;:excelx) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="829">
          
          
          <code class="ruby">        assert_equal 'Bericht aus dem Sekretariat', oo.cell(13,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="830">
          
          
          <code class="ruby">        assert_equal '1981-4', oo.cell(13,'D')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="831">
          
          
          <code class="ruby">        assert_equal String, oo.excelx_type(13,'E')[1].class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="832">
          
          
          <code class="ruby">        assert_equal [:numeric_or_formula,&quot;General&quot;], oo.excelx_type(13,'E')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="833">
          
          
          <code class="ruby">        assert_equal '428', oo.excelx_value(13,'E')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="834">
          
          
          <code class="ruby">        assert_equal 428.0, oo.cell(13,'E')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="835">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="836">
          
          
          <code class="ruby">	  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="837">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="838">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="839">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="840">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="841">
          
          
          <code class="ruby">      expected = [1.0,5.0,nil,10.0,Date.new(1961,11,21),'tata',nil,nil,nil,nil,'thisisa11',41.0,nil,nil,41.0,'einundvierzig',nil,Date.new(2007,5,31)]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="842">
          
          
          <code class="ruby">      assert_equal expected, oo.column(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="843">
          
          
          <code class="ruby">      assert_equal expected, oo.column('a')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="844">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="845">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="846">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="847">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_column_huge_document</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="848">
          
          
          <code class="ruby">    if LONG_RUN</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="849">
          
          
          <code class="ruby">      with_each_spreadsheet(:name=&gt;'Bibelbund', :format=&gt;[:openoffice,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="850">
          
          
          <code class="ruby">          :excel,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="851">
          
          
          <code class="ruby">          :excelx]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="852">
          
          
          <code class="ruby">        oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="853">
          
          
          <code class="ruby">        assert_equal 3735, oo.column('a').size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="854">
          
          
          <code class="ruby">        #assert_equal 499, oo.column('a').size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="855">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="856">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="857">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="858">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="859">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_simple_spreadsheet_find_by_condition</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="860">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'simple_spreadsheet') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="861">
          
          
          <code class="ruby">      oo.header_line = 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="862">
          
          
          <code class="ruby">      # oo.date_format = '%m/%d/%Y' if oo.class == Google</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="863">
          
          
          <code class="ruby">      erg = oo.find(:all, :conditions =&gt; {'Comment' =&gt; 'Task 1'})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="864">
          
          
          <code class="ruby">      assert_equal Date.new(2007,05,07), erg[1]['Date']</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="865">
          
          
          <code class="ruby">      assert_equal 10.75       , erg[1]['Start time']</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="866">
          
          
          <code class="ruby">      assert_equal 12.50       , erg[1]['End time']</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="867">
          
          
          <code class="ruby">      assert_equal 0           , erg[1]['Pause']</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="868">
          
          
          <code class="ruby">      assert_equal 1.75        , erg[1]['Sum'] unless oo.class == Roo::Excel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="869">
          
          
          <code class="ruby">      assert_equal &quot;Task 1&quot;    , erg[1]['Comment']</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="870">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="871">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="872">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="873">
          
          
          <code class="ruby">  # Ruby-spreadsheet now allows us to at least give the current value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="874">
          
          
          <code class="ruby">  # from a cell with a formula (no possible with parseexcel)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="875">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_false_borders_with_formulas</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="876">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'false_encoding', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="877">
          
          
          <code class="ruby">      assert_equal 1, oo.first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="878">
          
          
          <code class="ruby">      assert_equal 3, oo.last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="879">
          
          
          <code class="ruby">      assert_equal 1, oo.first_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="880">
          
          
          <code class="ruby">      assert_equal 4, oo.last_column</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="881">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="882">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="883">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="884">
          
          
          <code class="ruby">  # We'ce added minimal formula support so we can now read these</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="885">
          
          
          <code class="ruby">  # though not sure how the spreadsheet reports older values....</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="886">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_fe</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="887">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'false_encoding', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="888">
          
          
          <code class="ruby">      assert_equal Date.new(2007,11,1), oo.cell('a',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="889">
          
          
          <code class="ruby">      #DOES NOT WORK IN EXCEL FILES: assert_equal true, oo.formula?('a',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="890">
          
          
          <code class="ruby">      #DOES NOT WORK IN EXCEL FILES: assert_equal '=TODAY()', oo.formula('a',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="891">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="892">
          
          
          <code class="ruby">      assert_equal Date.new(2008,2,9), oo.cell('B',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="893">
          
          
          <code class="ruby">      #DOES NOT WORK IN EXCEL FILES: assert_equal true,               oo.formula?('B',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="894">
          
          
          <code class="ruby">      #DOES NOT WORK IN EXCEL FILES: assert_equal &quot;=A1+100&quot;,          oo.formula('B',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="895">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="896">
          
          
          <code class="ruby">      assert_kind_of DateTime, oo.cell('C',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="897">
          
          
          <code class="ruby">      #DOES NOT WORK IN EXCEL FILES: assert_equal true,               oo.formula?('C',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="898">
          
          
          <code class="ruby">      #DOES NOT WORK IN EXCEL FILES: assert_equal &quot;=C1&quot;,          oo.formula('C',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="899">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="900">
          
          
          <code class="ruby">      assert_equal 'H1', oo.cell('A',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="901">
          
          
          <code class="ruby">      assert_equal 'H2', oo.cell('B',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="902">
          
          
          <code class="ruby">      assert_equal 'H3', oo.cell('C',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="903">
          
          
          <code class="ruby">      assert_equal 'H4', oo.cell('D',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="904">
          
          
          <code class="ruby">      assert_equal 'R1', oo.cell('A',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="905">
          
          
          <code class="ruby">      assert_equal 'R2', oo.cell('B',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="906">
          
          
          <code class="ruby">      assert_equal 'R3', oo.cell('C',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="907">
          
          
          <code class="ruby">      assert_equal 'R4', oo.cell('D',3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="908">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="909">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="910">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="911">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_excel_does_not_support_formulas</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="912">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'false_encoding', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="913">
          
          
          <code class="ruby">      assert_raise(NotImplementedError) { oo.formula('a',1) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="914">
          
          
          <code class="ruby">      assert_raise(NotImplementedError) { oo.formula?('a',1) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="915">
          
          
          <code class="ruby">      assert_raise(NotImplementedError) { oo.formulas(oo.sheets.first) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="916">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="917">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="918">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="919">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_extension(oo)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="920">
          
          
          <code class="ruby">    case oo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="921">
          
          
          <code class="ruby">    when Roo::OpenOffice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="922">
          
          
          <code class="ruby">      &quot;.ods&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="923">
          
          
          <code class="ruby">    when Roo::Excel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="924">
          
          
          <code class="ruby">      &quot;.xls&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="925">
          
          
          <code class="ruby">    when Roo::Excelx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="926">
          
          
          <code class="ruby">      &quot;.xlsx&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="927">
          
          
          <code class="ruby">    when Roo::Google</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="928">
          
          
          <code class="ruby">      &quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="929">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="930">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="931">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="932">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_info</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="933">
          
          
          <code class="ruby">    expected_templ = &quot;File: numbers1%s\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="934">
          
          
          <code class="ruby">      &quot;Number of sheets: 5\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="935">
          
          
          <code class="ruby">      &quot;Sheets: Tabelle1, Name of Sheet 2, Sheet3, Sheet4, Sheet5\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="936">
          
          
          <code class="ruby">      &quot;Sheet 1:\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="937">
          
          
          <code class="ruby">      &quot;  First row: 1\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="938">
          
          
          <code class="ruby">      &quot;  Last row: 18\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="939">
          
          
          <code class="ruby">      &quot;  First column: A\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="940">
          
          
          <code class="ruby">      &quot;  Last column: G\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="941">
          
          
          <code class="ruby">      &quot;Sheet 2:\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="942">
          
          
          <code class="ruby">      &quot;  First row: 5\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="943">
          
          
          <code class="ruby">      &quot;  Last row: 14\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="944">
          
          
          <code class="ruby">      &quot;  First column: B\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="945">
          
          
          <code class="ruby">      &quot;  Last column: E\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="946">
          
          
          <code class="ruby">      &quot;Sheet 3:\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="947">
          
          
          <code class="ruby">      &quot;  First row: 1\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="948">
          
          
          <code class="ruby">      &quot;  Last row: 1\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="949">
          
          
          <code class="ruby">      &quot;  First column: A\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="950">
          
          
          <code class="ruby">      &quot;  Last column: BA\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="951">
          
          
          <code class="ruby">      &quot;Sheet 4:\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="952">
          
          
          <code class="ruby">      &quot;  First row: 1\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="953">
          
          
          <code class="ruby">      &quot;  Last row: 1\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="954">
          
          
          <code class="ruby">      &quot;  First column: A\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="955">
          
          
          <code class="ruby">      &quot;  Last column: E\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="956">
          
          
          <code class="ruby">      &quot;Sheet 5:\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="957">
          
          
          <code class="ruby">      &quot;  First row: 1\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="958">
          
          
          <code class="ruby">      &quot;  Last row: 6\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="959">
          
          
          <code class="ruby">      &quot;  First column: A\n&quot;+</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="960">
          
          
          <code class="ruby">      &quot;  Last column: E&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="961">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="962">
          
          
          <code class="ruby">      ext = get_extension(oo)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="963">
          
          
          <code class="ruby">      expected = sprintf(expected_templ,ext)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="964">
          
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="965">
          
          
          <code class="ruby">        if oo.class == Google</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="966">
          
          
          <code class="ruby">          assert_equal expected.gsub(/numbers1/,key_of(&quot;numbers1&quot;)), oo.info</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="967">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="968">
          
          
          <code class="ruby">          assert_equal expected, oo.info</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="969">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="970">
          
          
          <code class="ruby">      rescue NameError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="971">
          
          
          <code class="ruby">        #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="972">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="973">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="974">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="975">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="976">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_info_doesnt_set_default_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="977">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="978">
          
          
          <code class="ruby">      oo.default_sheet = 'Sheet3'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="979">
          
          
          <code class="ruby">      oo.info</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="980">
          
          
          <code class="ruby">      assert_equal 'Sheet3', oo.default_sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="981">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="982">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="983">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="984">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_excel_numbers1_sheet5_last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="985">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="986">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Tabelle1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="987">
          
          
          <code class="ruby">      assert_equal 1, oo.first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="988">
          
          
          <code class="ruby">      assert_equal 18, oo.last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="989">
          
          
          <code class="ruby">      assert_equal Roo::OpenOffice.letter_to_number('A'), oo.first_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="990">
          
          
          <code class="ruby">      assert_equal Roo::OpenOffice.letter_to_number('G'), oo.last_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="991">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Name of Sheet 2&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="992">
          
          
          <code class="ruby">      assert_equal 5, oo.first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="993">
          
          
          <code class="ruby">      assert_equal 14, oo.last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="994">
          
          
          <code class="ruby">      assert_equal Roo::OpenOffice.letter_to_number('B'), oo.first_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="995">
          
          
          <code class="ruby">      assert_equal Roo::OpenOffice.letter_to_number('E'), oo.last_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="996">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Sheet3&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="997">
          
          
          <code class="ruby">      assert_equal 1, oo.first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="998">
          
          
          <code class="ruby">      assert_equal 1, oo.last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="999">
          
          
          <code class="ruby">      assert_equal Roo::OpenOffice.letter_to_number('A'), oo.first_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1000">
          
          
          <code class="ruby">      assert_equal Roo::OpenOffice.letter_to_number('BA'), oo.last_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1001">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Sheet4&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1002">
          
          
          <code class="ruby">      assert_equal 1, oo.first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1003">
          
          
          <code class="ruby">      assert_equal 1, oo.last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1004">
          
          
          <code class="ruby">      assert_equal Roo::OpenOffice.letter_to_number('A'), oo.first_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1005">
          
          
          <code class="ruby">      assert_equal Roo::OpenOffice.letter_to_number('E'), oo.last_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1006">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Sheet5&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1007">
          
          
          <code class="ruby">      assert_equal 1, oo.first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1008">
          
          
          <code class="ruby">      assert_equal 6, oo.last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1009">
          
          
          <code class="ruby">      assert_equal Roo::OpenOffice.letter_to_number('A'), oo.first_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1010">
          
          
          <code class="ruby">      assert_equal Roo::OpenOffice.letter_to_number('E'), oo.last_column</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1011">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1012">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1013">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1014">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_should_raise_file_not_found_error</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1015">
          
          
          <code class="ruby">    if OPENOFFICE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1016">
          
          
          <code class="ruby">      assert_raise(IOError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1017">
          
          
          <code class="ruby">        Roo::OpenOffice.new(File.join('testnichtvorhanden','Bibelbund.ods'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1018">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1019">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1020">
          
          
          <code class="ruby">    if EXCEL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1021">
          
          
          <code class="ruby">      assert_raise(IOError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1022">
          
          
          <code class="ruby">        Roo::Excel.new(File.join('testnichtvorhanden','Bibelbund.xls'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1023">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1024">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1025">
          
          
          <code class="ruby">    if EXCELX</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1026">
          
          
          <code class="ruby">      assert_raise(IOError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1027">
          
          
          <code class="ruby">        Roo::Excelx.new(File.join('testnichtvorhanden','Bibelbund.xlsx'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1028">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1029">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1030">
          
          
          <code class="ruby">    if GOOGLE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1031">
          
          
          <code class="ruby">      # assert_raise(Net::HTTPServerException) {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1032">
          
          
          <code class="ruby">      #   Google.new(key_of('testnichtvorhanden'+'Bibelbund.ods'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1033">
          
          
          <code class="ruby">      #   Google.new('testnichtvorhanden')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1034">
          
          
          <code class="ruby">      # }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1035">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1036">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1037">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1038">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_write_google</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1039">
          
          
          <code class="ruby">    # write.me: http://spreadsheets.google.com/ccc?key=ptu6bbahNZpY0N0RrxQbWdw&amp;hl=en_GB</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1040">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'write.me', :format=&gt;:google) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1041">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1042">
          
          
          <code class="ruby">      oo.set(1,1,&quot;hello from the tests&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1043">
          
          
          <code class="ruby">      assert_equal &quot;hello from the tests&quot;, oo.cell(1,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1044">
          
          
          <code class="ruby">      oo.set(1,1, 1.0)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1045">
          
          
          <code class="ruby">      assert_equal 1.0, oo.cell(1,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1046">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1047">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1048">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1049">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_set_with_more_than_one_sheet_google</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1050">
          
          
          <code class="ruby">    # write.me: http://spreadsheets.google.com/ccc?key=ptu6bbahNZpY0N0RrxQbWdw&amp;hl=en_GB</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1051">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'write.me', :format=&gt;:google) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1052">
          
          
          <code class="ruby">      content1 = 'AAA'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1053">
          
          
          <code class="ruby">      content2 = 'BBB'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1054">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1055">
          
          
          <code class="ruby">      oo.set(1,1,content1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1056">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1057">
          
          
          <code class="ruby">      oo.set(1,1,content2) # in the second sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1058">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1059">
          
          
          <code class="ruby">      assert_equal content1, oo.cell(1,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1060">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1061">
          
          
          <code class="ruby">      assert_equal content2, oo.cell(1,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1062">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1063">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1064">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1065">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_set_with_sheet_argument_google</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1066">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'write.me', :format=&gt;:google) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1067">
          
          
          <code class="ruby">      random_row = rand(10)+1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1068">
          
          
          <code class="ruby">      random_column = rand(10)+1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1069">
          
          
          <code class="ruby">      content1 = 'ABC'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1070">
          
          
          <code class="ruby">      content2 = 'DEF'</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1071">
          
          
          <code class="ruby">      oo.set(random_row,random_column,content1,oo.sheets.first)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1072">
          
          
          <code class="ruby">      oo.set(random_row,random_column,content2,oo.sheets[1])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1073">
          
          
          <code class="ruby">      assert_equal content1, oo.cell(random_row,random_column,oo.sheets.first)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1074">
          
          
          <code class="ruby">      assert_equal content2, oo.cell(random_row,random_column,oo.sheets[1])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1075">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1076">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1077">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1078">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_set_for_non_existing_sheet_google</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1079">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'ptu6bbahNZpY0N0RrxQbWdw', :format=&gt;:google) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1080">
          
          
          <code class="ruby">      assert_raise(RangeError) { oo.set(1,1,&quot;dummy&quot;,&quot;no_sheet&quot;)   }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1081">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1082">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1083">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1084">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_bbu</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1085">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'bbu', :format=&gt;[:openoffice, :excelx, :excel]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1086">
          
          
          <code class="ruby">      assert_nothing_raised() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1087">
          
          
          <code class="ruby">        assert_equal &quot;File: bbu#{get_extension(oo)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1088">
          
          
          <code class="ruby">Number of sheets: 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1089">
          
          
          <code class="ruby">Sheets: 2007_12, Tabelle2, Tabelle3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1090">
          
          
          <code class="ruby">Sheet 1:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1091">
          
          
          <code class="ruby">  First row: 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1092">
          
          
          <code class="ruby">  Last row: 4</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1093">
          
          
          <code class="ruby">  First column: A</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1094">
          
          
          <code class="ruby">  Last column: F</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1095">
          
          
          <code class="ruby">Sheet 2:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1096">
          
          
          <code class="ruby">  - empty -</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1097">
          
          
          <code class="ruby">Sheet 3:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1098">
          
          
          <code class="ruby">  - empty -&quot;, oo.info</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1099">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1101">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets[1] # empty sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1102">
          
          
          <code class="ruby">      assert_nil oo.first_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1103">
          
          
          <code class="ruby">      assert_nil oo.last_row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1104">
          
          
          <code class="ruby">      assert_nil oo.first_column</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1105">
          
          
          <code class="ruby">      assert_nil oo.last_column</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1106">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1107">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1110">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_time_nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1111">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'time-test') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1112">
          
          
          <code class="ruby">      assert_equal 12*3600+13*60+14, oo.cell('B',1) # 12:13:14 (secs since midnight)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1113">
          
          
          <code class="ruby">      assert_equal :time, oo.celltype('B',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1114">
          
          
          <code class="ruby">      assert_equal 15*3600+16*60, oo.cell('C',1) # 15:16    (secs since midnight)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1115">
          
          
          <code class="ruby">      assert_equal :time, oo.celltype('C',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1116">
          
          
          <code class="ruby">      assert_equal 23*3600, oo.cell('D',1) # 23:00    (secs since midnight)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1117">
          
          
          <code class="ruby">      assert_equal :time, oo.celltype('D',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1118">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1121">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_date_time_to_csv</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1122">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'time-test') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1123">
          
          
          <code class="ruby">      Dir.mktmpdir do |tempdir|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1124">
          
          
          <code class="ruby">        csv_output = File.join(tempdir,'time_test.csv')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1125">
          
          
          <code class="ruby">        assert oo.to_csv(csv_output)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1126">
          
          
          <code class="ruby">        assert File.exists?(csv_output)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1127">
          
          
          <code class="ruby">        assert_equal &quot;&quot;, `diff --strip-trailing-cr #{TESTDIR}/time-test.csv #{csv_output}`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1128">
          
          
          <code class="ruby">        # --strip-trailing-cr is needed because the test-file use 0A and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1129">
          
          
          <code class="ruby">        # the test on an windows box generates 0D 0A as line endings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1130">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1131">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1132">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1134">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_boolean_to_csv</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1135">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'boolean') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1136">
          
          
          <code class="ruby">      Dir.mktmpdir do |tempdir|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1137">
          
          
          <code class="ruby">        csv_output = File.join(tempdir,'boolean.csv')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1138">
          
          
          <code class="ruby">        assert oo.to_csv(csv_output)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1139">
          
          
          <code class="ruby">        assert File.exists?(csv_output)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1140">
          
          
          <code class="ruby">        assert_equal &quot;&quot;, `diff --strip-trailing-cr #{TESTDIR}/boolean.csv #{csv_output}`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1141">
          
          
          <code class="ruby">        # --strip-trailing-cr is needed because the test-file use 0A and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1142">
          
          
          <code class="ruby">        # the test on an windows box generates 0D 0A as line endings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1143">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1144">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1145">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1146">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_link_to_csv</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1147">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'link',:format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1148">
          
          
          <code class="ruby">      Dir.mktmpdir do |tempdir|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1149">
          
          
          <code class="ruby">        csv_output = File.join(tempdir,'link.csv')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1150">
          
          
          <code class="ruby">        assert oo.to_csv(csv_output)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1151">
          
          
          <code class="ruby">        assert File.exists?(csv_output)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1152">
          
          
          <code class="ruby">puts `diff --strip-trailing-cr #{TESTDIR}/link.csv #{csv_output}`</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1153">
          
          
          <code class="ruby">        assert_equal &quot;&quot;, `diff --strip-trailing-cr #{TESTDIR}/link.csv #{csv_output}`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1154">
          
          
          <code class="ruby">        # --strip-trailing-cr is needed because the test-file use 0A and</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1155">
          
          
          <code class="ruby">        # the test on an windows box generates 0D 0A as line endings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1156">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1157">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1158">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1159">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_date_time_yaml</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1160">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'time-test') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1161">
          
          
          <code class="ruby">      expected =</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1162">
          
          
          <code class="ruby">        &quot;--- \ncell_1_1: \n  row: 1 \n  col: 1 \n  celltype: string \n  value: Mittags: \ncell_1_2: \n  row: 1 \n  col: 2 \n  celltype: time \n  value: 12:13:14 \ncell_1_3: \n  row: 1 \n  col: 3 \n  celltype: time \n  value: 15:16:00 \ncell_1_4: \n  row: 1 \n  col: 4 \n  celltype: time \n  value: 23:00:00 \ncell_2_1: \n  row: 2 \n  col: 1 \n  celltype: date \n  value: 2007-11-21 \n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1163">
          
          
          <code class="ruby">      assert_equal expected, oo.to_yaml</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1164">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1165">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1166">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1167">
          
          
          <code class="ruby">  # Erstellt eine Liste aller Zellen im Spreadsheet. Dies ist nötig, weil ein einfacher</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1168">
          
          
          <code class="ruby">  # Textvergleich des XML-Outputs nicht funktioniert, da xml-builder die Attribute</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1169">
          
          
          <code class="ruby">  # nicht immer in der gleichen Reihenfolge erzeugt.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1170">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_all_cells(oo,sheet)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1171">
          
          
          <code class="ruby">    all = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1172">
          
          
          <code class="ruby">    oo.first_row(sheet).upto(oo.last_row(sheet)) do |row|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1173">
          
          
          <code class="ruby">      oo.first_column(sheet).upto(oo.last_column(sheet)) do |col|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1174">
          
          
          <code class="ruby">        unless oo.empty?(row,col,sheet)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1175">
          
          
          <code class="ruby">          all &lt;&lt; {:row =&gt; row.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1176">
          
          
          <code class="ruby">            :column =&gt; col.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1177">
          
          
          <code class="ruby">            :content =&gt; oo.cell(row,col,sheet).to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1178">
          
          
          <code class="ruby">            :type =&gt; oo.celltype(row,col,sheet).to_s,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1179">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1180">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1181">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1182">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1183">
          
          
          <code class="ruby">    all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1184">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1185">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1186">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_to_xml</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1187">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1', :encoding =&gt; 'utf8') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1188">
          
          
          <code class="ruby">      assert_nothing_raised {oo.to_xml}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1189">
          
          
          <code class="ruby">      sheetname = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1190">
          
          
          <code class="ruby">      doc = Nokogiri::XML(oo.to_xml)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1191">
          
          
          <code class="ruby">      sheet_count = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1192">
          
          
          <code class="ruby">      doc.xpath('//spreadsheet/sheet').each {|tmpelem|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1193">
          
          
          <code class="ruby">        sheet_count += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1194">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1195">
          
          
          <code class="ruby">      assert_equal 5, sheet_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1196">
          
          
          <code class="ruby">      doc.xpath('//spreadsheet/sheet').each { |xml_sheet|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1197">
          
          
          <code class="ruby">        all_cells = init_all_cells(oo, sheetname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1198">
          
          
          <code class="ruby">        x = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1199">
          
          
          <code class="ruby">        assert_equal sheetname, xml_sheet.attributes['name'].value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1200">
          
          
          <code class="ruby">        xml_sheet.children.each {|cell|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1201">
          
          
          <code class="ruby">          if cell.attributes['name']</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1202">
          
          
          <code class="ruby">            expected = [all_cells[x][:row],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1203">
          
          
          <code class="ruby">              all_cells[x][:column],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1204">
          
          
          <code class="ruby">              all_cells[x][:content],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1205">
          
          
          <code class="ruby">              all_cells[x][:type],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1206">
          
          
          <code class="ruby">            ]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1207">
          
          
          <code class="ruby">            result = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1208">
          
          
          <code class="ruby">              cell.attributes['row'],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1209">
          
          
          <code class="ruby">              cell.attributes['column'],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1210">
          
          
          <code class="ruby">              cell.content,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1211">
          
          
          <code class="ruby">              cell.attributes['type'],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1212">
          
          
          <code class="ruby">            ]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1213">
          
          
          <code class="ruby">            assert_equal expected, result</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1214">
          
          
          <code class="ruby">            x += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1215">
          
          
          <code class="ruby">          end # if</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1216">
          
          
          <code class="ruby">        } # end of sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1217">
          
          
          <code class="ruby">        sheetname = oo.sheets[oo.sheets.index(sheetname)+1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1218">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1219">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1220">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1222">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_row_column_fixnum_float</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1223">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'bug-row-column-fixnum-float', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1224">
          
          
          <code class="ruby">      assert_equal 42.5, oo.cell('b',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1225">
          
          
          <code class="ruby">      assert_equal 43  , oo.cell('c',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1226">
          
          
          <code class="ruby">      assert_equal ['hij',42.5, 43], oo.row(2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1227">
          
          
          <code class="ruby">      assert_equal ['def',42.5, 'nop'], oo.column(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1228">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1229">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1230">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1231">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_file_warning_default</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1232">
          
          
          <code class="ruby">    if OPENOFFICE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1233">
          
          
          <code class="ruby">      assert_raises(TypeError, &quot;test/files/numbers1.xls is not an openoffice spreadsheet&quot;) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1234">
          
          
          <code class="ruby">        Roo::OpenOffice.new(File.join(TESTDIR,&quot;numbers1.xls&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1235">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1236">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::OpenOffice.new(File.join(TESTDIR,&quot;numbers1.xlsx&quot;)) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1237">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1238">
          
          
          <code class="ruby">    if EXCEL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1239">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::Excel.new(File.join(TESTDIR,&quot;numbers1.ods&quot;)) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1240">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::Excel.new(File.join(TESTDIR,&quot;numbers1.xlsx&quot;)) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1241">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1242">
          
          
          <code class="ruby">    if EXCELX</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1243">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::Excelx.new(File.join(TESTDIR,&quot;numbers1.ods&quot;)) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1244">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::Excelx.new(File.join(TESTDIR,&quot;numbers1.xls&quot;)) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1245">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1246">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1247">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1248">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_file_warning_error</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1249">
          
          
          <code class="ruby">    if OPENOFFICE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1250">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::OpenOffice.new(File.join(TESTDIR,&quot;numbers1.xls&quot;),false,:error) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1251">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::OpenOffice.new(File.join(TESTDIR,&quot;numbers1.xlsx&quot;),false,:error) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1252">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1253">
          
          
          <code class="ruby">    if EXCEL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1254">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::Excel.new(File.join(TESTDIR,&quot;numbers1.ods&quot;),false,:error) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1255">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::Excel.new(File.join(TESTDIR,&quot;numbers1.xlsx&quot;),false,:error) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1256">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1257">
          
          
          <code class="ruby">    if EXCELX</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1258">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::Excelx.new(File.join(TESTDIR,&quot;numbers1.ods&quot;),false,:error) }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1259">
          
          
          <code class="ruby">      assert_raises(TypeError) { Roo::Excelx.new(File.join(TESTDIR,&quot;numbers1.xls&quot;),false,:error) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1260">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1261">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1262">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1263">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_file_warning_warning</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1264">
          
          
          <code class="ruby">    if OPENOFFICE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1265">
          
          
          <code class="ruby">      assert_nothing_raised(TypeError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1266">
          
          
          <code class="ruby">        assert_raises(Zip::ZipError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1267">
          
          
          <code class="ruby">          Roo::OpenOffice.new(File.join(TESTDIR,&quot;numbers1.xls&quot;),false, :warning)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1268">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1269">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1270">
          
          
          <code class="ruby">      assert_nothing_raised(TypeError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1271">
          
          
          <code class="ruby">        assert_raises(Errno::ENOENT) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1272">
          
          
          <code class="ruby">          Roo::OpenOffice.new(File.join(TESTDIR,&quot;numbers1.xlsx&quot;),false, :warning)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1273">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1274">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1275">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1276">
          
          
          <code class="ruby">    if EXCEL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1277">
          
          
          <code class="ruby">      assert_nothing_raised(TypeError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1278">
          
          
          <code class="ruby">        assert_raises(Ole::Storage::FormatError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1279">
          
          
          <code class="ruby">          Roo::Excel.new(File.join(TESTDIR,&quot;numbers1.ods&quot;),false, :warning)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1280">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1281">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1282">
          
          
          <code class="ruby">      assert_nothing_raised(TypeError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1283">
          
          
          <code class="ruby">        assert_raises(Ole::Storage::FormatError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1284">
          
          
          <code class="ruby">          Roo::Excel.new(File.join(TESTDIR,&quot;numbers1.xlsx&quot;),false, :warning)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1285">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1286">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1287">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1288">
          
          
          <code class="ruby">    if EXCELX</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1289">
          
          
          <code class="ruby">      assert_nothing_raised(TypeError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1290">
          
          
          <code class="ruby">        assert_raises(Errno::ENOENT) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1291">
          
          
          <code class="ruby">          Roo::Excelx.new(File.join(TESTDIR,&quot;numbers1.ods&quot;),false, :warning)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1292">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1293">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1294">
          
          
          <code class="ruby">      assert_nothing_raised(TypeError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1295">
          
          
          <code class="ruby">        assert_raises(Zip::ZipError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1296">
          
          
          <code class="ruby">          Roo::Excelx.new(File.join(TESTDIR,&quot;numbers1.xls&quot;),false, :warning)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1297">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1298">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1299">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1300">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1301">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1302">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_file_warning_ignore</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1303">
          
          
          <code class="ruby">    if OPENOFFICE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1304">
          
          
          <code class="ruby">      # Files, die eigentlich OpenOffice-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1305">
          
          
          <code class="ruby">      # Files sind, aber die falsche Endung haben.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1306">
          
          
          <code class="ruby">      # Es soll ohne Fehlermeldung oder Warnung</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1307">
          
          
          <code class="ruby">      # oder Abbruch die Datei geoffnet werden</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1309">
          
          
          <code class="ruby">      # xls</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1310">
          
          
          <code class="ruby">      assert_nothing_raised() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1311">
          
          
          <code class="ruby">        Roo::OpenOffice.new(File.join(TESTDIR,&quot;type_openoffice.xls&quot;),false, :ignore)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1312">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1313">
          
          
          <code class="ruby">      # xlsx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1314">
          
          
          <code class="ruby">      assert_nothing_raised() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1315">
          
          
          <code class="ruby">        Roo::OpenOffice.new(File.join(TESTDIR,&quot;type_openoffice.xlsx&quot;),false, :ignore)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1316">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1317">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1318">
          
          
          <code class="ruby">    if EXCEL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1319">
          
          
          <code class="ruby">      assert_nothing_raised() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1320">
          
          
          <code class="ruby">        Roo::Excel.new(File.join(TESTDIR,&quot;type_excel.ods&quot;),false, :ignore)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1321">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1322">
          
          
          <code class="ruby">      assert_nothing_raised() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1323">
          
          
          <code class="ruby">        Roo::Excel.new(File.join(TESTDIR,&quot;type_excel.xlsx&quot;),false, :ignore)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1324">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1325">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1326">
          
          
          <code class="ruby">    if EXCELX</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1327">
          
          
          <code class="ruby">      assert_nothing_raised() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1328">
          
          
          <code class="ruby">        Roo::Excelx.new(File.join(TESTDIR,&quot;type_excelx.ods&quot;),false, :ignore)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1329">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1330">
          
          
          <code class="ruby">      assert_nothing_raised() {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1331">
          
          
          <code class="ruby">        Roo::Excelx.new(File.join(TESTDIR,&quot;type_excelx.xls&quot;),false, :ignore)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1332">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1333">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1334">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1335">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1336">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_last_row_excel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1337">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'time-test', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1338">
          
          
          <code class="ruby">      assert_equal 2, oo.last_row</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1339">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1340">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1341">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1342">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_to_xml_with_empty_sheets</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1343">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'emptysheets', :format=&gt;[:openoffice, :excel]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1344">
          
          
          <code class="ruby">      oo.sheets.each { |sheet|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1345">
          
          
          <code class="ruby">        assert_equal nil, oo.first_row, &quot;first_row not nil in sheet #{sheet}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1346">
          
          
          <code class="ruby">        assert_equal nil, oo.last_row, &quot;last_row not nil in sheet #{sheet}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1347">
          
          
          <code class="ruby">        assert_equal nil, oo.first_column, &quot;first_column not nil in sheet #{sheet}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1348">
          
          
          <code class="ruby">        assert_equal nil, oo.last_column, &quot;last_column not nil in sheet #{sheet}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1349">
          
          
          <code class="ruby">        assert_equal nil, oo.first_row(sheet), &quot;first_row not nil in sheet #{sheet}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1350">
          
          
          <code class="ruby">        assert_equal nil, oo.last_row(sheet), &quot;last_row not nil in sheet #{sheet}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1351">
          
          
          <code class="ruby">        assert_equal nil, oo.first_column(sheet), &quot;first_column not nil in sheet #{sheet}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1352">
          
          
          <code class="ruby">        assert_equal nil, oo.last_column(sheet), &quot;last_column not nil in sheet #{sheet}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1353">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1354">
          
          
          <code class="ruby">      assert_nothing_raised() { oo.to_xml }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1355">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1356">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1357">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1358">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_simple_spreadsheet_time_bug</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1359">
          
          
          <code class="ruby">    # really a bug? are cells really of type time?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1360">
          
          
          <code class="ruby">    # No! :float must be the correct type</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1361">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'simple_spreadsheet', :format=&gt;:excelx) do |oo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1362">
          
          
          <code class="ruby">      # puts oo.cell('B',5).to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1363">
          
          
          <code class="ruby">      # assert_equal :time, oo.celltype('B',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1364">
          
          
          <code class="ruby">      assert_equal :float, oo.celltype('B',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1365">
          
          
          <code class="ruby">      assert_equal 10.75, oo.cell('B',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1366">
          
          
          <code class="ruby">      assert_equal 12.50, oo.cell('C',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1367">
          
          
          <code class="ruby">      assert_equal 0, oo.cell('D',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1368">
          
          
          <code class="ruby">      assert_equal 1.75, oo.cell('E',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1369">
          
          
          <code class="ruby">      assert_equal 'Task 1', oo.cell('F',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1370">
          
          
          <code class="ruby">      assert_equal Date.new(2007,5,7), oo.cell('A',5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1371">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1372">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1373">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1374">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_simple2_excelx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1375">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'simple_spreadsheet', :format=&gt;:excelx) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1376">
          
          
          <code class="ruby">      assert_equal [:numeric_or_formula, &quot;yyyy\\-mm\\-dd&quot;], oo.excelx_type('A',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1377">
          
          
          <code class="ruby">      assert_equal [:numeric_or_formula, &quot;#,##0.00&quot;], oo.excelx_type('B',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1378">
          
          
          <code class="ruby">      assert_equal [:numeric_or_formula, &quot;#,##0.00&quot;], oo.excelx_type('c',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1379">
          
          
          <code class="ruby">      assert_equal [:numeric_or_formula, &quot;General&quot;], oo.excelx_type('d',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1380">
          
          
          <code class="ruby">      assert_equal [:numeric_or_formula, &quot;General&quot;], oo.excelx_type('e',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1381">
          
          
          <code class="ruby">      assert_equal :string, oo.excelx_type('f',4)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1382">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1383">
          
          
          <code class="ruby">      assert_equal &quot;39209&quot;, oo.excelx_value('a',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1384">
          
          
          <code class="ruby">      assert_equal &quot;yyyy\\-mm\\-dd&quot;, oo.excelx_format('a',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1385">
          
          
          <code class="ruby">      assert_equal &quot;9.25&quot;, oo.excelx_value('b',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1386">
          
          
          <code class="ruby">      assert_equal &quot;10.25&quot;, oo.excelx_value('c',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1387">
          
          
          <code class="ruby">      assert_equal &quot;0&quot;, oo.excelx_value('d',4)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1388">
          
          
          <code class="ruby">      #... Sum-Spalte</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1389">
          
          
          <code class="ruby">      # assert_equal &quot;Task 1&quot;, oo.excelx_value('f',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1390">
          
          
          <code class="ruby">      assert_equal &quot;Task 1&quot;, oo.cell('f',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1391">
          
          
          <code class="ruby">      assert_equal Date.new(2007,05,07), oo.cell('a',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1392">
          
          
          <code class="ruby">      assert_equal &quot;9.25&quot;, oo.excelx_value('b',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1393">
          
          
          <code class="ruby">      assert_equal &quot;#,##0.00&quot;, oo.excelx_format('b',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1394">
          
          
          <code class="ruby">      assert_equal 9.25, oo.cell('b',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1395">
          
          
          <code class="ruby">      assert_equal :float, oo.celltype('b',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1396">
          
          
          <code class="ruby">      assert_equal :float, oo.celltype('d',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1397">
          
          
          <code class="ruby">      assert_equal 0, oo.cell('d',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1398">
          
          
          <code class="ruby">      assert_equal :formula, oo.celltype('e',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1399">
          
          
          <code class="ruby">      assert_equal 1, oo.cell('e',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1400">
          
          
          <code class="ruby">      assert_equal 'C4-B4-D4', oo.formula('e',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1401">
          
          
          <code class="ruby">      assert_equal :string, oo.celltype('f',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1402">
          
          
          <code class="ruby">      assert_equal &quot;Task 1&quot;, oo.cell('f',4)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1403">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1404">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1405">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1406">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_datetime</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1407">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'datetime') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1408">
          
          
          <code class="ruby">      val = oo.cell('c',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1409">
          
          
          <code class="ruby">      assert_kind_of DateTime, val</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1410">
          
          
          <code class="ruby">      assert_equal :datetime, oo.celltype('c',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1411">
          
          
          <code class="ruby">      assert_equal DateTime.new(1961,11,21,12,17,18), val</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1412">
          
          
          <code class="ruby">      val = oo.cell('a',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1413">
          
          
          <code class="ruby">      assert_kind_of Date, val</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1414">
          
          
          <code class="ruby">      assert_equal :date, oo.celltype('a',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1415">
          
          
          <code class="ruby">      assert_equal Date.new(1961,11,21), val</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1416">
          
          
          <code class="ruby">      assert_equal Date.new(1961,11,21), oo.cell('a',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1417">
          
          
          <code class="ruby">      assert_equal DateTime.new(1961,11,21,12,17,18), oo.cell('a',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1418">
          
          
          <code class="ruby">      assert_equal DateTime.new(1961,11,21,12,17,18), oo.cell('b',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1419">
          
          
          <code class="ruby">      assert_equal DateTime.new(1961,11,21,12,17,18), oo.cell('c',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1420">
          
          
          <code class="ruby">      assert_equal DateTime.new(1961,11,21,12,17,18), oo.cell('a',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1421">
          
          
          <code class="ruby">      assert_equal DateTime.new(1961,11,21,12,17,18), oo.cell('b',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1422">
          
          
          <code class="ruby">      assert_equal DateTime.new(1961,11,21,12,17,18), oo.cell('c',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1423">
          
          
          <code class="ruby">      assert_equal DateTime.new(1961,11,21,12,17,18), oo.cell('a',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1424">
          
          
          <code class="ruby">      assert_equal DateTime.new(1961,11,21,12,17,18), oo.cell('b',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1425">
          
          
          <code class="ruby">      assert_equal DateTime.new(1961,11,21,12,17,18), oo.cell('c',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1426">
          
          
          <code class="ruby">      assert_equal Date.new(1961,11,21), oo.cell('a',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1427">
          
          
          <code class="ruby">      assert_equal Date.new(1961,11,21), oo.cell('b',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1428">
          
          
          <code class="ruby">      assert_equal Date.new(1961,11,21), oo.cell('c',6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1429">
          
          
          <code class="ruby">      assert_equal Date.new(1961,11,21), oo.cell('a',7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1430">
          
          
          <code class="ruby">      assert_equal Date.new(1961,11,21), oo.cell('b',7)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1431">
          
          
          <code class="ruby">      assert_equal Date.new(1961,11,21), oo.cell('c',7)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1432">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1433">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1434">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1435">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_cell_openoffice_html_escape</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1436">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'html-escape', :format=&gt;:openoffice) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1437">
          
          
          <code class="ruby">      assert_equal &quot;'&quot;, oo.cell(1,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1438">
          
          
          <code class="ruby">      assert_equal &quot;&amp;&quot;, oo.cell(2,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1439">
          
          
          <code class="ruby">      assert_equal &quot;&gt;&quot;, oo.cell(3,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1440">
          
          
          <code class="ruby">      assert_equal &quot;&lt;&quot;, oo.cell(4,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1441">
          
          
          <code class="ruby">      assert_equal &quot;`&quot;, oo.cell(5,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1442">
          
          
          <code class="ruby">      # test_openoffice_zipped will catch issues with &amp;quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1443">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1444">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1445">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1446">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_cell_boolean</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1447">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'boolean', :format=&gt;[:openoffice, :excel, :excelx]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1448">
          
          
          <code class="ruby">      if oo.class == Roo::Excelx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1449">
          
          
          <code class="ruby">        assert_equal &quot;TRUE&quot;, oo.cell(1,1), &quot;failure in &quot;+oo.class.to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1450">
          
          
          <code class="ruby">        assert_equal &quot;FALSE&quot;, oo.cell(2,1), &quot;failure in &quot;+oo.class.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1451">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1452">
          
          
          <code class="ruby">        assert_equal &quot;true&quot;, oo.cell(1,1), &quot;failure in &quot;+oo.class.to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1453">
          
          
          <code class="ruby">        assert_equal &quot;false&quot;, oo.cell(2,1), &quot;failure in &quot;+oo.class.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1454">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1455">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1456">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1457">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1458">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_cell_multiline</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1459">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'paragraph', :format=&gt;[:openoffice, :excel, :excelx]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1460">
          
          
          <code class="ruby">      assert_equal &quot;This is a test\nof a multiline\nCell&quot;, oo.cell(1,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1461">
          
          
          <code class="ruby">      assert_equal &quot;This is a test\n¶\nof a multiline\n\nCell&quot;, oo.cell(1,2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1462">
          
          
          <code class="ruby">      assert_equal &quot;first p\n\nsecond p\n\nlast p&quot;, oo.cell(2,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1463">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1464">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1465">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1466">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_cell_styles</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1467">
          
          
          <code class="ruby">    # styles only valid in excel spreadsheets?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1468">
          
          
          <code class="ruby">    # TODO: what todo with other spreadsheet types</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1469">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'style', :format=&gt;[# :openoffice,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1470">
          
          
          <code class="ruby">        :excel,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1471">
          
          
          <code class="ruby">        # :excelx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1472">
          
          
          <code class="ruby">      ]) do |oo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1473">
          
          
          <code class="ruby">      # bold</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1474">
          
          
          <code class="ruby">      assert_equal true,  oo.font(1,1).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1475">
          
          
          <code class="ruby">      assert_equal false, oo.font(1,1).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1476">
          
          
          <code class="ruby">      assert_equal false, oo.font(1,1).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1477">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1478">
          
          
          <code class="ruby">      # italic</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1479">
          
          
          <code class="ruby">      assert_equal false, oo.font(2,1).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1480">
          
          
          <code class="ruby">      assert_equal true,  oo.font(2,1).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1481">
          
          
          <code class="ruby">      assert_equal false, oo.font(2,1).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1482">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1483">
          
          
          <code class="ruby">      # normal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1484">
          
          
          <code class="ruby">      assert_equal false, oo.font(3,1).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1485">
          
          
          <code class="ruby">      assert_equal false, oo.font(3,1).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1486">
          
          
          <code class="ruby">      assert_equal false, oo.font(3,1).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1487">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1488">
          
          
          <code class="ruby">      # underline</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1489">
          
          
          <code class="ruby">      assert_equal false, oo.font(4,1).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1490">
          
          
          <code class="ruby">      assert_equal false, oo.font(4,1).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1491">
          
          
          <code class="ruby">      assert_equal true,  oo.font(4,1).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1492">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1493">
          
          
          <code class="ruby">      # bold italic</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1494">
          
          
          <code class="ruby">      assert_equal true,  oo.font(5,1).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1495">
          
          
          <code class="ruby">      assert_equal true,  oo.font(5,1).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1496">
          
          
          <code class="ruby">      assert_equal false, oo.font(5,1).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1497">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1498">
          
          
          <code class="ruby">      # bold underline</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1499">
          
          
          <code class="ruby">      assert_equal true,  oo.font(6,1).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1500">
          
          
          <code class="ruby">      assert_equal false, oo.font(6,1).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1501">
          
          
          <code class="ruby">      assert_equal true,  oo.font(6,1).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1502">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1503">
          
          
          <code class="ruby">      # italic underline</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1504">
          
          
          <code class="ruby">      assert_equal false, oo.font(7,1).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1505">
          
          
          <code class="ruby">      assert_equal true,  oo.font(7,1).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1506">
          
          
          <code class="ruby">      assert_equal true,  oo.font(7,1).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1507">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1508">
          
          
          <code class="ruby">      # bolded row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1509">
          
          
          <code class="ruby">      assert_equal true, oo.font(8,1).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1510">
          
          
          <code class="ruby">      assert_equal false,  oo.font(8,1).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1511">
          
          
          <code class="ruby">      assert_equal false,  oo.font(8,1).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1512">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1513">
          
          
          <code class="ruby">      # bolded col</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1514">
          
          
          <code class="ruby">      assert_equal true, oo.font(9,2).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1515">
          
          
          <code class="ruby">      assert_equal false,  oo.font(9,2).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1516">
          
          
          <code class="ruby">      assert_equal false,  oo.font(9,2).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1517">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1518">
          
          
          <code class="ruby">      # bolded row, italic col</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1519">
          
          
          <code class="ruby">      assert_equal true, oo.font(10,3).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1520">
          
          
          <code class="ruby">      assert_equal true,  oo.font(10,3).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1521">
          
          
          <code class="ruby">      assert_equal false,  oo.font(10,3).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1522">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1523">
          
          
          <code class="ruby">      # normal</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1524">
          
          
          <code class="ruby">      assert_equal false, oo.font(11,4).bold?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1525">
          
          
          <code class="ruby">      assert_equal false,  oo.font(11,4).italic?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1526">
          
          
          <code class="ruby">      assert_equal false,  oo.font(11,4).underline?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1527">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1528">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1529">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1530">
          
          
          <code class="ruby">  # If a cell has a date-like string but is preceeded by a '</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1531">
          
          
          <code class="ruby">  # to force that date to be treated like a string, we were getting an exception.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1532">
          
          
          <code class="ruby">  # This test just checks for that exception to make sure it's not raised in this case</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1533">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_date_to_float_conversion</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1534">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'datetime_floatconv', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1535">
          
          
          <code class="ruby">      assert_nothing_raised(NoMethodError) do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1536">
          
          
          <code class="ruby">        oo.cell('a',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1537">
          
          
          <code class="ruby">        oo.cell('a',2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1538">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1539">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1540">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1541">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1542">
          
          
          <code class="ruby">  # Need to extend to other formats</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1543">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_row_whitespace</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1544">
          
          
          <code class="ruby">    # auf dieses Dokument habe ich keinen Zugriff TODO:</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1545">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'whitespace') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1546">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Sheet1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1547">
          
          
          <code class="ruby">      assert_equal [nil, nil, nil, nil, nil, nil], oo.row(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1548">
          
          
          <code class="ruby">      assert_equal [nil, nil, nil, nil, nil, nil], oo.row(2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1549">
          
          
          <code class="ruby">      assert_equal [&quot;Date&quot;, &quot;Start time&quot;, &quot;End time&quot;, &quot;Pause&quot;, &quot;Sum&quot;, &quot;Comment&quot;], oo.row(3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1550">
          
          
          <code class="ruby">      assert_equal [Date.new(2007,5,7), 9.25, 10.25, 0.0, 1.0, &quot;Task 1&quot;], oo.row(4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1551">
          
          
          <code class="ruby">      assert_equal [nil, nil, nil, nil, nil, nil], oo.row(5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1552">
          
          
          <code class="ruby">      assert_equal [Date.new(2007,5,7), 10.75, 10.75, 0.0, 0.0, &quot;Task 1&quot;], oo.row(6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1553">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Sheet2&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1554">
          
          
          <code class="ruby">      assert_equal [&quot;Date&quot;, nil, &quot;Start time&quot;], oo.row(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1555">
          
          
          <code class="ruby">      assert_equal [Date.new(2007,5,7), nil, 9.25], oo.row(2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1556">
          
          
          <code class="ruby">      assert_equal [Date.new(2007,5,7), nil,  10.75], oo.row(3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1557">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1558">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1559">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1560">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_col_whitespace</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1561">
          
          
          <code class="ruby">    #TODO:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1562">
          
          
          <code class="ruby">    # kein Zugriff auf Dokument whitespace</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1563">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'whitespace') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1564">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Sheet1&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1565">
          
          
          <code class="ruby">      assert_equal [&quot;Date&quot;, Date.new(2007,5,7), nil, Date.new(2007,5,7)], oo.column(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1566">
          
          
          <code class="ruby">      assert_equal [&quot;Start time&quot;, 9.25, nil, 10.75], oo.column(2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1567">
          
          
          <code class="ruby">      assert_equal [&quot;End time&quot;, 10.25, nil, 10.75], oo.column(3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1568">
          
          
          <code class="ruby">      assert_equal [&quot;Pause&quot;, 0.0, nil, 0.0], oo.column(4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1569">
          
          
          <code class="ruby">      assert_equal [&quot;Sum&quot;, 1.0, nil, 0.0], oo.column(5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1570">
          
          
          <code class="ruby">      assert_equal [&quot;Comment&quot;,&quot;Task 1&quot;, nil, &quot;Task 1&quot;], oo.column(6)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1571">
          
          
          <code class="ruby">      oo.default_sheet = &quot;Sheet2&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1572">
          
          
          <code class="ruby">      assert_equal [nil, nil, nil], oo.column(1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1573">
          
          
          <code class="ruby">      assert_equal [nil, nil, nil], oo.column(2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1574">
          
          
          <code class="ruby">      assert_equal [&quot;Date&quot;, Date.new(2007,5,7), Date.new(2007,5,7)], oo.column(3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1575">
          
          
          <code class="ruby">      assert_equal [nil, nil, nil], oo.column(4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1576">
          
          
          <code class="ruby">      assert_equal [ &quot;Start time&quot;, 9.25, 10.75], oo.column(5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1577">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1578">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1579">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1580">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_ruby_spreadsheet_formula_bug</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1581">
          
          
          <code class="ruby">     with_each_spreadsheet(:name=&gt;'formula_parse_error', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1582">
          
          
          <code class="ruby">       assert_equal '5026', oo.cell(2,3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1583">
          
          
          <code class="ruby">       assert_equal '5026', oo.cell(3,3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1584">
          
          
          <code class="ruby">     end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1585">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1586">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1587">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1588">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_excel_links</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1589">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'link', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1590">
          
          
          <code class="ruby">      assert_equal 'Google', oo.cell(1,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1591">
          
          
          <code class="ruby">      assert_equal 'http://www.google.com', oo.cell(1,1).url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1592">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1593">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1594">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1595">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_excelx_links</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1596">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'link', :format=&gt;:excelx) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1597">
          
          
          <code class="ruby">      assert_equal 'Google', oo.cell(1,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1598">
          
          
          <code class="ruby">      assert_equal 'http://www.google.com', oo.cell(1,1).url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1599">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1600">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1601">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1602">
          
          
          <code class="ruby">  # Excel has two base date formats one from 1900 and the other from 1904.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1603">
          
          
          <code class="ruby">  # There's a MS bug that 1900 base dates include an extra day due to erroneously</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1604">
          
          
          <code class="ruby">  # including 1900 as a leap yar.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1605">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_base_dates_in_excel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1606">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'1900_base', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1607">
          
          
          <code class="ruby">      assert_equal Date.new(2009,06,15), oo.cell(1,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1608">
          
          
          <code class="ruby">      #we don't want to to 'interpret' formulas  assert_equal Date.new(Time.now.year,Time.now.month,Time.now.day), oo.cell(2,1) #formula for TODAY()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1609">
          
          
          <code class="ruby">      # if we test TODAY() we have also have to calculate</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1610">
          
          
          <code class="ruby">      # other date calculations</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1611">
          
          
          <code class="ruby">      #</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1612">
          
          
          <code class="ruby">      assert_equal :date, oo.celltype(1,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1613">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1614">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'1904_base', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1615">
          
          
          <code class="ruby">      assert_equal Date.new(2009,06,15), oo.cell(1,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1616">
          
          
          <code class="ruby">      # see comment above</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1617">
          
          
          <code class="ruby">      # assert_equal Date.new(Time.now.year,Time.now.month,Time.now.day), oo.cell(2,1) #formula for TODAY()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1618">
          
          
          <code class="ruby">      assert_equal :date, oo.celltype(1,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1619">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1620">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1621">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1622">
          
          
          <code class="ruby">  # Excel has two base date formats one from 1900 and the other from 1904.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1623">
          
          
          <code class="ruby">  # see #test_base_dates_in_excel</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1624">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_base_dates_in_excelx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1625">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'1900_base', :format=&gt;:excelx) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1626">
          
          
          <code class="ruby">      assert_equal Date.new(2009,06,15), oo.cell(1,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1627">
          
          
          <code class="ruby">      assert_equal :date, oo.celltype(1,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1628">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1629">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'1904_base', :format=&gt;:excelx) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1630">
          
          
          <code class="ruby">      assert_equal Date.new(2009,06,15), oo.cell(1,1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1631">
          
          
          <code class="ruby">      assert_equal :date, oo.celltype(1,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1632">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1633">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1634">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1635">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bad_date</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1636">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'prova', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1637">
          
          
          <code class="ruby">      assert_nothing_raised(ArgumentError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1638">
          
          
          <code class="ruby">        assert_equal DateTime.new(2006,2,2,10,0,0), oo.cell('a',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1639">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1640">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1641">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1642">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1643">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bad_excel_date</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1644">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'bad_excel_date', :format=&gt;:excel) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1645">
          
          
          <code class="ruby">      assert_nothing_raised(ArgumentError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1646">
          
          
          <code class="ruby">        assert_equal DateTime.new(2006,2,2,10,0,0), oo.cell('a',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1647">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1648">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1649">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1650">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1651">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_cell_methods</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1652">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'numbers1') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1653">
          
          
          <code class="ruby">      assert_equal 10, oo.a4 # cell(4,'A')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1654">
          
          
          <code class="ruby">      assert_equal 11, oo.b4 # cell(4,'B')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1655">
          
          
          <code class="ruby">      assert_equal 12, oo.c4 # cell(4,'C')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1656">
          
          
          <code class="ruby">      assert_equal 13, oo.d4 # cell(4,'D')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1657">
          
          
          <code class="ruby">      assert_equal 14, oo.e4 # cell(4,'E')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1658">
          
          
          <code class="ruby">      assert_equal 'ABC', oo.c6('Sheet5')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1659">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1660">
          
          
          <code class="ruby">      #assert_raises(ArgumentError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1661">
          
          
          <code class="ruby">      assert_raises(NoMethodError) {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1662">
          
          
          <code class="ruby">        # a42a is not a valid cell name, should raise ArgumentError</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1663">
          
          
          <code class="ruby">        assert_equal 9999, oo.a42a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1664">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1665">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1666">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1667">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1668">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1669">
          
          
          <code class="ruby">  # compare large spreadsheets</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1670">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_compare_large_spreadsheets</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1671">
          
          
          <code class="ruby">    # problematisch, weil Formeln in Excel nicht unterstützt werden</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1672">
          
          
          <code class="ruby">    if LONG_RUN</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1673">
          
          
          <code class="ruby">      qq = Roo::OpenOffice.new(File.join('test',&quot;Bibelbund.ods&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1674">
          
          
          <code class="ruby">      with_each_spreadsheet(:name=&gt;'Bibelbund') do |oo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1675">
          
          
          <code class="ruby">        # p &quot;comparing Bibelbund.ods with #{oo.class}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1676">
          
          
          <code class="ruby">        oo.sheets.each do |sh|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1677">
          
          
          <code class="ruby">          oo.first_row.upto(oo.last_row) do |row|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1678">
          
          
          <code class="ruby">            oo.first_column.upto(oo.last_column) do |col|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1679">
          
          
          <code class="ruby">              c1 = qq.cell(row,col,sh)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1680">
          
          
          <code class="ruby">              c1.force_encoding(&quot;UTF-8&quot;) if c1.class == String</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1681">
          
          
          <code class="ruby">              c2 = oo.cell(row,col,sh)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1682">
          
          
          <code class="ruby">              c2.force_encoding(&quot;UTF-8&quot;) if c2.class == String</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1683">
          
          
          <code class="ruby">              assert_equal c1, c2, &quot;diff in #{sh}/#{row}/#{col}}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1684">
          
          
          <code class="ruby">              assert_equal qq.celltype(row,col,sh), oo.celltype(row,col,sh)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1685">
          
          
          <code class="ruby">              assert_equal qq.formula?(row,col,sh), oo.formula?(row,col,sh) if oo.class != Roo::Excel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1686">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1687">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1688">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1689">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1690">
          
          
          <code class="ruby">    end # LONG_RUN</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1691">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1692">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1693">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_label</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1694">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'named_cells', :format=&gt;[:openoffice,:excelx,:libreoffice]) do |oo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1695">
          
          
          <code class="ruby">      # oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1696">
          
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1697">
          
          
          <code class="ruby">        row,col = oo.label('anton')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1698">
          
          
          <code class="ruby">      rescue ArgumentError</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1699">
          
          
          <code class="ruby">        puts &quot;labels error at #{oo.class}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1700">
          
          
          <code class="ruby">        raise</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1701">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1702">
          
          
          <code class="ruby">      assert_equal 5, row, &quot;error with label in class #{oo.class}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1703">
          
          
          <code class="ruby">      assert_equal 3, col, &quot;error with label in class #{oo.class}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1704">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1705">
          
          
          <code class="ruby">      row,col = oo.label('anton')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1706">
          
          
          <code class="ruby">      assert_equal 'Anton', oo.cell(row,col), &quot;error with label in class #{oo.class}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1707">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1708">
          
          
          <code class="ruby">      row,col = oo.label('berta')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1709">
          
          
          <code class="ruby">      assert_equal 'Bertha', oo.cell(row,col), &quot;error with label in class #{oo.class}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1710">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1711">
          
          
          <code class="ruby">      row,col = oo.label('caesar')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1712">
          
          
          <code class="ruby">      assert_equal 'Cäsar', oo.cell(row,col),&quot;error with label in class #{oo.class}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1713">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1714">
          
          
          <code class="ruby">      row,col = oo.label('never')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1715">
          
          
          <code class="ruby">      assert_nil row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1716">
          
          
          <code class="ruby">      assert_nil col</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1717">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1718">
          
          
          <code class="ruby">      row,col,sheet = oo.label('anton')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1719">
          
          
          <code class="ruby">      assert_equal 5, row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1720">
          
          
          <code class="ruby">      assert_equal 3, col</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1721">
          
          
          <code class="ruby">      assert_equal &quot;Sheet1&quot;, sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1722">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1723">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1724">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1725">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_method_missing_anton</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1726">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'named_cells', :format=&gt;[:openoffice,:excelx,:libreoffice]) do |oo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1727">
          
          
          <code class="ruby">      # oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1728">
          
          
          <code class="ruby">      assert_equal &quot;Anton&quot;, oo.anton</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1729">
          
          
          <code class="ruby">      assert_raises(NoMethodError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1730">
          
          
          <code class="ruby">        oo.never</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1731">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1732">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1733">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1734">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1735">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_labels</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1736">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'named_cells', :format=&gt;[:openoffice,:excelx,:libreoffice]) do |oo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1737">
          
          
          <code class="ruby">      # oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1738">
          
          
          <code class="ruby">      assert_equal [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1739">
          
          
          <code class="ruby">	      ['anton',[5,3,'Sheet1']],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1740">
          
          
          <code class="ruby">	      ['berta',[4,2,'Sheet1']],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1741">
          
          
          <code class="ruby">	      ['caesar',[7,2,'Sheet1']],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1742">
          
          
          <code class="ruby">      ], oo.labels, &quot;error with labels array in class #{oo.class}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1743">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1744">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1745">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1746">
          <span class="hits">1</span>
          
          <code class="ruby">   def test_labeled_cells</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1747">
          
          
          <code class="ruby">     with_each_spreadsheet(:name=&gt;'named_cells', :format=&gt;[:openoffice,:excelx,:libreoffice]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1748">
          
          
          <code class="ruby">       oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1749">
          
          
          <code class="ruby">       begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1750">
          
          
          <code class="ruby">         row,col = oo.label('anton')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1751">
          
          
          <code class="ruby">       rescue ArgumentError</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1752">
          
          
          <code class="ruby">         puts &quot;labels error at #{oo.class}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1753">
          
          
          <code class="ruby">         raise</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1754">
          
          
          <code class="ruby">       end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1755">
          
          
          <code class="ruby">       assert_equal 5, row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1756">
          
          
          <code class="ruby">       assert_equal 3, col</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1757">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1758">
          
          
          <code class="ruby">       row,col = oo.label('anton')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1759">
          
          
          <code class="ruby">       assert_equal 'Anton', oo.cell(row,col)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1760">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1761">
          
          
          <code class="ruby">       row,col = oo.label('berta')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1762">
          
          
          <code class="ruby">       assert_equal 'Bertha', oo.cell(row,col)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1763">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1764">
          
          
          <code class="ruby">       row,col = oo.label('caesar')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1765">
          
          
          <code class="ruby">       assert_equal 'Cäsar', oo.cell(row,col)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1766">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1767">
          
          
          <code class="ruby">       row,col = oo.label('never')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1768">
          
          
          <code class="ruby">       assert_nil row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1769">
          
          
          <code class="ruby">       assert_nil col</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1770">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1771">
          
          
          <code class="ruby">       row,col,sheet = oo.label('anton')</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1772">
          
          
          <code class="ruby">       assert_equal 5, row</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1773">
          
          
          <code class="ruby">       assert_equal 3, col</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1774">
          
          
          <code class="ruby">       assert_equal &quot;Sheet1&quot;, sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1775">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1776">
          
          
          <code class="ruby">       assert_equal &quot;Anton&quot;, oo.anton</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1777">
          
          
          <code class="ruby">       assert_raises(NoMethodError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1778">
          
          
          <code class="ruby">         row,col = oo.never</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1779">
          
          
          <code class="ruby">       }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1780">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1781">
          
          
          <code class="ruby">  # Reihenfolge row,col,sheet analog zu #label</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1782">
          
          
          <code class="ruby">       assert_equal [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1783">
          
          
          <code class="ruby">  	      ['anton',[5,3,'Sheet1']],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1784">
          
          
          <code class="ruby">  	      ['berta',[4,2,'Sheet1']],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1785">
          
          
          <code class="ruby">  	      ['caesar',[7,2,'Sheet1']],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1786">
          
          
          <code class="ruby">       ], oo.labels, &quot;error with labels array in class #{oo.class}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1787">
          
          
          <code class="ruby">     end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1788">
          
          
          <code class="ruby">   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1789">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1790">
          <span class="hits">1</span>
          
          <code class="ruby">  require 'matrix'</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1791">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_matrix</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1792">
          
          
          <code class="ruby">    with_each_spreadsheet(:name =&gt; 'matrix', :format =&gt; [:openoffice, :excel, :google]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1793">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1794">
          
          
          <code class="ruby">      assert_equal Matrix[</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1795">
          
          
          <code class="ruby">        [1.0, 2.0, 3.0],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1796">
          
          
          <code class="ruby">        [4.0, 5.0, 6.0],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1797">
          
          
          <code class="ruby">        [7.0, 8.0, 9.0] ], oo.to_matrix</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1798">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1799">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1800">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1801">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_matrix_selected_range</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1802">
          
          
          <code class="ruby">    with_each_spreadsheet(:name =&gt; 'matrix', :format=&gt;[:excel,:openoffice,:google]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1803">
          
          
          <code class="ruby">      oo.default_sheet = 'Sheet2'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1804">
          
          
          <code class="ruby">      assert_equal Matrix[</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1805">
          
          
          <code class="ruby">        [1.0, 2.0, 3.0],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1806">
          
          
          <code class="ruby">        [4.0, 5.0, 6.0],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1807">
          
          
          <code class="ruby">        [7.0, 8.0, 9.0] ], oo.to_matrix(3,4,5,6)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1808">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1809">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1810">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1811">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_matrix_all_nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1812">
          
          
          <code class="ruby">    with_each_spreadsheet(:name =&gt; 'matrix', :format=&gt;[:excel,:openoffice,:google]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1813">
          
          
          <code class="ruby">      oo.default_sheet = 'Sheet2'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1814">
          
          
          <code class="ruby">      assert_equal Matrix[</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1815">
          
          
          <code class="ruby">        [nil, nil, nil],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1816">
          
          
          <code class="ruby">        [nil, nil, nil],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1817">
          
          
          <code class="ruby">        [nil, nil, nil] ], oo.to_matrix(10,10,12,12)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1818">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1819">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1820">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1821">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_matrix_values_and_nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1822">
          
          
          <code class="ruby">    with_each_spreadsheet(:name =&gt; 'matrix', :format=&gt;[:excel,:openoffice,:google]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1823">
          
          
          <code class="ruby">      oo.default_sheet = 'Sheet3'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1824">
          
          
          <code class="ruby">      assert_equal Matrix[</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1825">
          
          
          <code class="ruby">        [1.0, nil, 3.0],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1826">
          
          
          <code class="ruby">        [4.0, 5.0, 6.0],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1827">
          
          
          <code class="ruby">        [7.0, 8.0, nil] ], oo.to_matrix(1,1,3,3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1828">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1829">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1830">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1831">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_matrix_specifying_sheet</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1832">
          
          
          <code class="ruby">    with_each_spreadsheet(:name =&gt; 'matrix', :format =&gt; [:openoffice, :excel, :google]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1833">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1834">
          
          
          <code class="ruby">      assert_equal Matrix[</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1835">
          
          
          <code class="ruby">        [1.0, nil, 3.0],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1836">
          
          
          <code class="ruby">        [4.0, 5.0, 6.0],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1837">
          
          
          <code class="ruby">        [7.0, 8.0, nil] ], oo.to_matrix(nil, nil, nil, nil, 'Sheet3')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1838">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1839">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1840">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1841">
          
          
          <code class="ruby">  # unter Windows soll es laut Bug-Reports nicht moeglich sein, eine Excel-Datei, die</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1842">
          
          
          <code class="ruby">  # mit Excel.new geoeffnet wurde nach dem Processing anschliessend zu loeschen.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1843">
          
          
          <code class="ruby">  # Anmerkung: Das Spreadsheet-Gem erlaubt kein explizites Close von Spreadsheet-Dateien,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1844">
          
          
          <code class="ruby">  # was verhindern koennte, das die Datei geloescht werden kann.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1845">
          
          
          <code class="ruby">  # def test_bug_cannot_delete_opened_excel_sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1846">
          
          
          <code class="ruby">  #   with_each_spreadsheet(:name=&gt;'simple_spreadsheet') do |oo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1847">
          
          
          <code class="ruby">  #     'kopiere  nach temporaere Datei und versuche diese zu oeffnen und zu loeschen'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1848">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1849">
          
          
          <code class="ruby">  # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1850">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1851">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_xlsx_reference_cell</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1852">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1853">
          
          
          <code class="ruby">    if EXCELX</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1854">
          
          
          <code class="ruby">=begin</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1855">
          
          
          <code class="ruby">    If cell A contains a string and cell B references cell A.  When reading the value of cell B, the result will be</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1856">
          
          
          <code class="ruby">&quot;0.0&quot; instead of the value of cell A.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1857">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1858">
          
          
          <code class="ruby">With the attached test case, I ran the following code:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1859">
          
          
          <code class="ruby">spreadsheet = Roo::Excelx.new('formula_string_error.xlsx')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1860">
          
          
          <code class="ruby">spreadsheet.default_sheet = 'sheet1'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1861">
          
          
          <code class="ruby">p &quot;A: #{spreadsheet.cell(1, 1)}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1862">
          
          
          <code class="ruby">p &quot;B: #{spreadsheet.cell(2, 1)}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1863">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1864">
          
          
          <code class="ruby">with the following results</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1865">
          
          
          <code class="ruby">&quot;A: TestString&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1866">
          
          
          <code class="ruby">&quot;B: 0.0&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1867">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1868">
          
          
          <code class="ruby">where the expected result is</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1869">
          
          
          <code class="ruby">&quot;A: TestString&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1870">
          
          
          <code class="ruby">&quot;B: TestString&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1871">
          
          
          <code class="ruby">=end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1872">
          
          
          <code class="ruby">      xlsx = Roo::Excelx.new(File.join(TESTDIR, &quot;formula_string_error.xlsx&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1873">
          
          
          <code class="ruby">      xlsx.default_sheet = xlsx.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1874">
          
          
          <code class="ruby">      assert_equal 'Teststring', xlsx.cell('a',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1875">
          
          
          <code class="ruby">      assert_equal 'Teststring', xlsx.cell('a',2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1876">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1877">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1878">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1879">
          
          
          <code class="ruby">  # #formulas of an empty sheet should return an empty array and not result in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1880">
          
          
          <code class="ruby">  # an error message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1881">
          
          
          <code class="ruby">  # 2011-06-24</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1882">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_formulas_empty_sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1883">
          
          
          <code class="ruby">    with_each_spreadsheet(:name =&gt;'emptysheets',</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1884">
          
          
          <code class="ruby">      :format=&gt;[:openoffice,:excelx,:google]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1885">
          
          
          <code class="ruby">      assert_nothing_raised(NoMethodError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1886">
          
          
          <code class="ruby">        oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1887">
          
          
          <code class="ruby">        oo.formulas</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1888">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1889">
          
          
          <code class="ruby">      assert_equal([], oo.formulas)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1890">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1891">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1892">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1893">
          
          
          <code class="ruby">  # #to_yaml of an empty sheet should return an empty string and not result in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1894">
          
          
          <code class="ruby">  # an error message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1895">
          
          
          <code class="ruby">  # 2011-06-24</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1896">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_to_yaml_empty_sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1897">
          
          
          <code class="ruby">    with_each_spreadsheet(:name =&gt;'emptysheets',</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1898">
          
          
          <code class="ruby">      :format=&gt;[:openoffice,:excelx,:google]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1899">
          
          
          <code class="ruby">      assert_nothing_raised(NoMethodError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1900">
          
          
          <code class="ruby">        oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1901">
          
          
          <code class="ruby">        oo.to_yaml</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1902">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1903">
          
          
          <code class="ruby">      assert_equal('', oo.to_yaml)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1904">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1905">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1906">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1907">
          
          
          <code class="ruby">  # #to_matrix of an empty sheet should return an empty matrix and not result in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1908">
          
          
          <code class="ruby">  # an error message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1909">
          
          
          <code class="ruby">  # 2011-06-25</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1910">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_to_matrix_empty_sheet</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1911">
          
          
          <code class="ruby">    with_each_spreadsheet(:name =&gt;'emptysheets',</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1912">
          
          
          <code class="ruby">      :format=&gt;[:openoffice,:excelx,:google]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1913">
          
          
          <code class="ruby">      assert_nothing_raised(NoMethodError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1914">
          
          
          <code class="ruby">        oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1915">
          
          
          <code class="ruby">        oo.to_matrix</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1916">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1917">
          
          
          <code class="ruby">      assert_equal(Matrix.empty(0,0), oo.to_matrix)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1918">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1919">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1920">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1921">
          
          
          <code class="ruby">  # 2011-08-03</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1922">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_datetime_to_csv</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1923">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'datetime') do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1924">
          
          
          <code class="ruby">      Dir.mktmpdir do |tempdir|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1925">
          
          
          <code class="ruby">        datetime_csv_file = File.join(tempdir,&quot;datetime.csv&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1926">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1927">
          
          
          <code class="ruby">        assert oo.to_csv(datetime_csv_file)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1928">
          
          
          <code class="ruby">        assert File.exists?(datetime_csv_file)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1929">
          
          
          <code class="ruby">        assert_equal &quot;&quot;, file_diff('test/files/so_datetime.csv', datetime_csv_file)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1930">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1931">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1932">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1933">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1934">
          
          
          <code class="ruby">  # 2011-08-11</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1935">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_openoffice_formula_missing_letters</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1936">
          
          
          <code class="ruby">    if LIBREOFFICE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1937">
          
          
          <code class="ruby">      # Dieses Dokument wurde mit LibreOffice angelegt.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1938">
          
          
          <code class="ruby">      # Keine Ahnung, ob es damit zusammenhaengt, das diese</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1939">
          
          
          <code class="ruby">      # Formeln anders sind, als in der Datei formula.ods, welche</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1940">
          
          
          <code class="ruby">      # mit OpenOffice angelegt wurde.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1941">
          
          
          <code class="ruby">      # Bei den OpenOffice-Dateien ist in diesem Feld in der XML-</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1942">
          
          
          <code class="ruby">      # Datei of: als Prefix enthalten, waehrend in dieser Datei</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1943">
          
          
          <code class="ruby">      # irgendetwas mit oooc: als Prefix verwendet wird.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1944">
          
          
          <code class="ruby">      oo = Roo::OpenOffice.new(File.join(TESTDIR,'dreimalvier.ods'))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1945">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1946">
          
          
          <code class="ruby">      assert_equal '=SUM([.A1:.D1])', oo.formula('e',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1947">
          
          
          <code class="ruby">      assert_equal '=SUM([.A2:.D2])', oo.formula('e',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1948">
          
          
          <code class="ruby">      assert_equal '=SUM([.A3:.D3])', oo.formula('e',3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1949">
          
          
          <code class="ruby">      assert_equal [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1950">
          
          
          <code class="ruby">       [1,5,'=SUM([.A1:.D1])'],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1951">
          
          
          <code class="ruby">        [2,5,'=SUM([.A2:.D2])'],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1952">
          
          
          <code class="ruby">        [3,5,'=SUM([.A3:.D3])'],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="1953">
          
          
          <code class="ruby">      ], oo.formulas</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1954">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1955">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1956">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1957">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1958">
          
          
          <code class="ruby">=begin</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1959">
          
          
          <code class="ruby">  def test_postprocessing_and_types_in_csv</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1960">
          
          
          <code class="ruby">    if CSV</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1961">
          
          
          <code class="ruby">      oo = CSV.new(File.join(TESTDIR,'csvtypes.csv'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1962">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1963">
          
          
          <code class="ruby">      assert_equal(1,oo.a1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1964">
          
          
          <code class="ruby">      assert_equal(:float,oo.celltype('A',1))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1965">
          
          
          <code class="ruby">      assert_equal(&quot;2&quot;,oo.b1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1966">
          
          
          <code class="ruby">      assert_equal(:string,oo.celltype('B',1))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1967">
          
          
          <code class="ruby">      assert_equal(&quot;Mayer&quot;,oo.c1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1968">
          
          
          <code class="ruby">      assert_equal(:string,oo.celltype('C',1))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1969">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1970">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1971">
          
          
          <code class="ruby">=end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1972">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1973">
          
          
          <code class="ruby">=begin</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1974">
          
          
          <code class="ruby">  def test_postprocessing_with_callback_function</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1975">
          
          
          <code class="ruby">    if CSV</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1976">
          
          
          <code class="ruby">      oo = CSV.new(File.join(TESTDIR,'csvtypes.csv'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1977">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1978">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1979">
          
          
          <code class="ruby">      #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1980">
          
          
          <code class="ruby">      assert_equal(1, oo.last_column)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1981">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1982">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1983">
          
          
          <code class="ruby">=end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1984">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1985">
          
          
          <code class="ruby">=begin</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1986">
          
          
          <code class="ruby">  def x_123</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1987">
          
          
          <code class="ruby">  class ::CSV</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1988">
          
          
          <code class="ruby">    def cell_postprocessing(row,col,value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1989">
          
          
          <code class="ruby">      if row &lt; 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1990">
          
          
          <code class="ruby">        return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1991">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1992">
          
          
          <code class="ruby">      return value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1993">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1994">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1995">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1996">
          
          
          <code class="ruby">=end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1997">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1998">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_nil_rows_and_lines_csv</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1999">
          
          
          <code class="ruby">	  # x_123</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2000">
          
          
          <code class="ruby">	  if CSV</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2001">
          
          
          <code class="ruby">		  oo = Roo::CSV.new(File.join(TESTDIR,'Bibelbund.csv'))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2002">
          
          
          <code class="ruby">		  oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2003">
          
          
          <code class="ruby">		  assert_equal 1, oo.first_row</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2004">
          
          
          <code class="ruby">	  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2005">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2006">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2007">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_pfand_from_windows_phone_xlsx</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2008">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'Pfand_from_windows_phone', :format=&gt;:excelx) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2009">
          
          
          <code class="ruby">	    oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2010">
          
          
          <code class="ruby">	    assert_equal ['Blatt1','Blatt2','Blatt3'], oo.sheets</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2011">
          
          
          <code class="ruby">	    assert_equal 'Summe', oo.cell('b',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2012">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2013">
          
          
          <code class="ruby">	    assert_equal Date.new(2011,9,14), oo.cell('a',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2014">
          
          
          <code class="ruby">	    assert_equal :date, oo.celltype('a',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2015">
          
          
          <code class="ruby">	    assert_equal Date.new(2011,9,15), oo.cell('a',3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2016">
          
          
          <code class="ruby">	    assert_equal :date, oo.celltype('a',3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2017">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2018">
          
          
          <code class="ruby">	    assert_equal 3.81, oo.cell('b',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2019">
          
          
          <code class="ruby">	    assert_equal &quot;SUM(C2:L2)&quot;, oo.formula('b',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2020">
          
          
          <code class="ruby">	    assert_equal 0.7, oo.cell('c',2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2021">
          
          
          <code class="ruby">    end # each</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2022">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2023">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2024">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_comment</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2025">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'comments', :format=&gt;[:openoffice,:libreoffice,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2026">
          
          
          <code class="ruby">        :excelx]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2027">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2028">
          
          
          <code class="ruby">      assert_equal 'Kommentar fuer B4',oo.comment('b',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2029">
          
          
          <code class="ruby">      assert_equal 'Kommentar fuer B5',oo.comment('b',5)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2030">
          
          
          <code class="ruby">      assert_nil oo.comment('b',99)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2031">
          
          
          <code class="ruby">      # no comment at the second page</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2032">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2033">
          
          
          <code class="ruby">      assert_nil oo.comment('b',4)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2034">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2035">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2036">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2037">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_comment?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2038">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'comments', :format=&gt;[:openoffice,:libreoffice,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2039">
          
          
          <code class="ruby">        :excelx]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2040">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2041">
          
          
          <code class="ruby">      assert_equal true, oo.comment?('b',4)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2042">
          
          
          <code class="ruby">      assert_equal false, oo.comment?('b',99)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2043">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2044">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2045">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2046">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_comments</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2047">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'comments', :format=&gt;[:openoffice,:libreoffice,</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2048">
          
          
          <code class="ruby">        :excelx]) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2049">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2050">
          
          
          <code class="ruby">      assert_equal [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2051">
          
          
          <code class="ruby">        [4, 2, &quot;Kommentar fuer B4&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2052">
          
          
          <code class="ruby">        [5, 2, &quot;Kommentar fuer B5&quot;],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2053">
          
          
          <code class="ruby">      ], oo.comments(oo.sheets.first), &quot;comments error in class #{oo.class}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2054">
          
          
          <code class="ruby">      # no comments at the second page</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2055">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2056">
          
          
          <code class="ruby">      assert_equal [], oo.comments, &quot;comments error in class #{oo.class}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2057">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2058">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2059">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2060">
          
          
          <code class="ruby">  ## PREVIOUSLY SKIPPED</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2061">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2062">
          
          
          <code class="ruby">  # don't have these test files so removing. We can easily add in</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2063">
          
          
          <code class="ruby">  # by modifying with_each_spreadsheet</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2064">
          <span class="hits">1</span>
          
          <code class="ruby">  GNUMERIC_ODS = false  # do gnumeric with ods files Tests?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2065">
          <span class="hits">1</span>
          
          <code class="ruby">  OPENOFFICEWRITE = false # experimental: write access with OO-Documents</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2066">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2067">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_writeopenoffice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2068">
          
          
          <code class="ruby">    if OPENOFFICEWRITE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2069">
          
          
          <code class="ruby">      File.cp(File.join(TESTDIR,&quot;numbers1.ods&quot;),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2070">
          
          
          <code class="ruby">        File.join(TESTDIR,&quot;numbers2.ods&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2071">
          
          
          <code class="ruby">      File.cp(File.join(TESTDIR,&quot;numbers2.ods&quot;),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2072">
          
          
          <code class="ruby">        File.join(TESTDIR,&quot;bak_numbers2.ods&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2073">
          
          
          <code class="ruby">      oo = OpenOffice.new(File.join(TESTDIR,&quot;numbers2.ods&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2074">
          
          
          <code class="ruby">      oo.default_sheet = oo.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2075">
          
          
          <code class="ruby">      oo.first_row.upto(oo.last_row) {|y|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2076">
          
          
          <code class="ruby">        oo.first_column.upto(oo.last_column) {|x|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2077">
          
          
          <code class="ruby">          unless oo.empty?(y,x)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2078">
          
          
          <code class="ruby">            # oo.set(y, x, oo.cell(y,x) + 7) if oo.celltype(y,x) == &quot;float&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2079">
          
          
          <code class="ruby">            oo.set(y, x, oo.cell(y,x) + 7) if oo.celltype(y,x) == :float</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2080">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2081">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2082">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2083">
          
          
          <code class="ruby">      oo.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2084">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2085">
          
          
          <code class="ruby">      oo1 = Roo::OpenOffice.new(File.join(TESTDIR,&quot;numbers2.ods&quot;))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2086">
          
          
          <code class="ruby">      oo2 = Roo::OpenOffice.new(File.join(TESTDIR,&quot;bak_numbers2.ods&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2087">
          
          
          <code class="ruby">      #p oo2.to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2088">
          
          
          <code class="ruby">      assert_equal 999, oo2.cell('a',1), oo2.cell('a',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2089">
          
          
          <code class="ruby">      assert_equal oo2.cell('a',1) + 7, oo1.cell('a',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2090">
          
          
          <code class="ruby">      assert_equal oo2.cell('b',1)+7, oo1.cell('b',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2091">
          
          
          <code class="ruby">      assert_equal oo2.cell('c',1)+7, oo1.cell('c',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2092">
          
          
          <code class="ruby">      assert_equal oo2.cell('d',1)+7, oo1.cell('d',1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2093">
          
          
          <code class="ruby">      assert_equal oo2.cell('a',2)+7, oo1.cell('a',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2094">
          
          
          <code class="ruby">      assert_equal oo2.cell('b',2)+7, oo1.cell('b',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2095">
          
          
          <code class="ruby">      assert_equal oo2.cell('c',2)+7, oo1.cell('c',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2096">
          
          
          <code class="ruby">      assert_equal oo2.cell('d',2)+7, oo1.cell('d',2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2097">
          
          
          <code class="ruby">      assert_equal oo2.cell('e',2)+7, oo1.cell('e',2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2098">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2099">
          
          
          <code class="ruby">      File.cp(File.join(TESTDIR,&quot;bak_numbers2.ods&quot;),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2100">
          
          
          <code class="ruby">        File.join(TESTDIR,&quot;numbers2.ods&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2101">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2102">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2104">
          <span class="hits">1</span>
          
          <code class="ruby">  def common_possible_bug_snowboard_cells(ss)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2105">
          
          
          <code class="ruby">    assert_equal &quot;A.&quot;, ss.cell(13,'A'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2106">
          
          
          <code class="ruby">    assert_equal 147, ss.cell(13,'f'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2107">
          
          
          <code class="ruby">    assert_equal 152, ss.cell(13,'g'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2108">
          
          
          <code class="ruby">    assert_equal 156, ss.cell(13,'h'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2109">
          
          
          <code class="ruby">    assert_equal 158, ss.cell(13,'i'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2110">
          
          
          <code class="ruby">    assert_equal 160, ss.cell(13,'j'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2111">
          
          
          <code class="ruby">    assert_equal 164, ss.cell(13,'k'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2112">
          
          
          <code class="ruby">    assert_equal 168, ss.cell(13,'l'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2113">
          
          
          <code class="ruby">    assert_equal :string, ss.celltype(13,'m'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2114">
          
          
          <code class="ruby">    assert_equal &quot;159W&quot;, ss.cell(13,'m'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2115">
          
          
          <code class="ruby">    assert_equal &quot;164W&quot;, ss.cell(13,'n'), ss.class</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2116">
          
          
          <code class="ruby">    assert_equal &quot;168W&quot;, ss.cell(13,'o'), ss.class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2117">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2119">
          
          
          <code class="ruby">  # def test_false_encoding</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2120">
          
          
          <code class="ruby">  #   ex = Roo::Excel.new(File.join(TESTDIR,'false_encoding.xls'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2121">
          
          
          <code class="ruby">  #   ex.default_sheet = ex.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2122">
          
          
          <code class="ruby">  #   assert_equal &quot;Sheet1&quot;, ex.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2123">
          
          
          <code class="ruby">  #   ex.first_row.upto(ex.last_row) do |row|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2124">
          
          
          <code class="ruby">  #     ex.first_column.upto(ex.last_column) do |col|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2125">
          
          
          <code class="ruby">  #       content = ex.cell(row,col)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2126">
          
          
          <code class="ruby">  #       puts &quot;#{row}/#{col}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2127">
          
          
          <code class="ruby">  #       #puts content if ! ex.empty?(row,col) or ex.formula?(row,col)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2128">
          
          
          <code class="ruby">  #       if ex.formula?(row,col)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2129">
          
          
          <code class="ruby">  #         #! ex.empty?(row,col)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2130">
          
          
          <code class="ruby">  #         puts content</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2131">
          
          
          <code class="ruby">  #       end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2132">
          
          
          <code class="ruby">  #     end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2133">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2134">
          
          
          <code class="ruby">  # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2136">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_simple_google</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2137">
          
          
          <code class="ruby">    if GOOGLE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2138">
          
          
          <code class="ruby">      go = Roo::Google.new(&quot;egal&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2139">
          
          
          <code class="ruby">      assert_equal &quot;42&quot;, go.cell(1,1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2140">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2141">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2143">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_download_uri</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2144">
          
          
          <code class="ruby">    if ONLINE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2145">
          
          
          <code class="ruby">      if OPENOFFICE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2146">
          
          
          <code class="ruby">        assert_raises(RuntimeError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2147">
          
          
          <code class="ruby">          Roo::OpenOffice.new(&quot;http://gibbsnichtdomainxxxxx.com/file.ods&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2148">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2149">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2150">
          
          
          <code class="ruby">      if EXCEL</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2151">
          
          
          <code class="ruby">        assert_raises(RuntimeError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2152">
          
          
          <code class="ruby">          Roo::Excel.new(&quot;http://gibbsnichtdomainxxxxx.com/file.xls&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2153">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2154">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2155">
          
          
          <code class="ruby">      if EXCELX</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2156">
          
          
          <code class="ruby">        assert_raises(RuntimeError) {</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2157">
          
          
          <code class="ruby">          Roo::Excelx.new(&quot;http://gibbsnichtdomainxxxxx.com/file.xlsx&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2158">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2159">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2160">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2161">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2162">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2163">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_download_uri_with_query_string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2164">
          
          
          <code class="ruby">    dir = File.expand_path(&quot;#{File.dirname __FILE__}/files&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2165">
          
          
          <code class="ruby">    { xls:  [EXCEL,       Roo::Excel],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2166">
          
          
          <code class="ruby">      xlsx: [EXCELX,      Roo::Excelx],</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2167">
          
          
          <code class="ruby">      ods:  [OPENOFFICE,  Roo::OpenOffice]}.each do |extension, (flag, type)|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2168">
          
          
          <code class="ruby">        if flag</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2169">
          
          
          <code class="ruby">          file = &quot;#{dir}/simple_spreadsheet.#{extension}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2170">
          
          
          <code class="ruby">          url = &quot;http://test.example.com/simple_spreadsheet.#{extension}?query-param=value&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2171">
          
          
          <code class="ruby">          stub_request(:any, url).to_return(body: File.read(file))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2172">
          
          
          <code class="ruby">          spreadsheet = type.new(url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2173">
          
          
          <code class="ruby">          spreadsheet.default_sheet = spreadsheet.sheets.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2174">
          
          
          <code class="ruby">          assert_equal 'Task 1', spreadsheet.cell('f', 4)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2175">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2176">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2177">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2178">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2179">
          
          
          <code class="ruby">  # def test_soap_server</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2180">
          
          
          <code class="ruby">  #   #threads = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2181">
          
          
          <code class="ruby">  #   #threads &lt;&lt; Thread.new(&quot;serverthread&quot;) do</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2182">
          
          
          <code class="ruby">  #   fork do</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2183">
          
          
          <code class="ruby">  #     p &quot;serverthread started&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2184">
          
          
          <code class="ruby">  #     puts &quot;in child, pid = #$$&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2185">
          
          
          <code class="ruby">  #     puts `/usr/bin/ruby rooserver.rb`</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2186">
          
          
          <code class="ruby">  #     p &quot;serverthread finished&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2187">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2188">
          
          
          <code class="ruby">  #   #threads &lt;&lt; Thread.new(&quot;clientthread&quot;) do</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2189">
          
          
          <code class="ruby">  #   p &quot;clientthread started&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2190">
          
          
          <code class="ruby">  #   sleep 10</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2191">
          
          
          <code class="ruby">  #   proxy = SOAP::RPC::Driver.new(&quot;http://localhost:12321&quot;,&quot;spreadsheetserver&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2192">
          
          
          <code class="ruby">  #   proxy.add_method('cell','row','col')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2193">
          
          
          <code class="ruby">  #   proxy.add_method('officeversion')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2194">
          
          
          <code class="ruby">  #   proxy.add_method('last_row')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2195">
          
          
          <code class="ruby">  #   proxy.add_method('last_column')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2196">
          
          
          <code class="ruby">  #   proxy.add_method('first_row')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2197">
          
          
          <code class="ruby">  #   proxy.add_method('first_column')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2198">
          
          
          <code class="ruby">  #   proxy.add_method('sheets')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2199">
          
          
          <code class="ruby">  #   proxy.add_method('set_default_sheet','s')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2200">
          
          
          <code class="ruby">  #   proxy.add_method('ferien_fuer_region', 'region')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2202">
          
          
          <code class="ruby">  #   sheets = proxy.sheets</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2203">
          
          
          <code class="ruby">  #   p sheets</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2204">
          
          
          <code class="ruby">  #   proxy.set_default_sheet(sheets.first)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2205">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2206">
          
          
          <code class="ruby">  #   assert_equal 1, proxy.first_row</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2207">
          
          
          <code class="ruby">  #   assert_equal 1, proxy.first_column</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2208">
          
          
          <code class="ruby">  #   assert_equal 187, proxy.last_row</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2209">
          
          
          <code class="ruby">  #   assert_equal 7, proxy.last_column</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2210">
          
          
          <code class="ruby">  #   assert_equal 42, proxy.cell('C',8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2211">
          
          
          <code class="ruby">  #   assert_equal 43, proxy.cell('F',12)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2212">
          
          
          <code class="ruby">  #   assert_equal &quot;1.0&quot;, proxy.officeversion</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2213">
          
          
          <code class="ruby">  #   p &quot;clientthread finished&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2214">
          
          
          <code class="ruby">  #   #end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2215">
          
          
          <code class="ruby">  #   #threads.each {|t| t.join }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2216">
          
          
          <code class="ruby">  #   puts &quot;fertig&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2217">
          
          
          <code class="ruby">  #   Process.kill(&quot;INT&quot;,pid)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2218">
          
          
          <code class="ruby">  #   pid = Process.wait</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2219">
          
          
          <code class="ruby">  #   puts &quot;child terminated, pid= #{pid}, status= #{$?.exitstatus}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2220">
          
          
          <code class="ruby">  # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2222">
          <span class="hits">1</span>
          
          <code class="ruby">  def split_coord(s)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2223">
          
          
          <code class="ruby">    letter = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2224">
          
          
          <code class="ruby">    number = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2225">
          
          
          <code class="ruby">    i = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2226">
          
          
          <code class="ruby">    while i&lt;s.length and &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;.include?(s[i,1])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2227">
          
          
          <code class="ruby">      letter += s[i,1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2228">
          
          
          <code class="ruby">      i+=1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2229">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2230">
          
          
          <code class="ruby">    while i&lt;s.length and &quot;01234567890&quot;.include?(s[i,1])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2231">
          
          
          <code class="ruby">      number = number*10 + s[i,1].to_i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2232">
          
          
          <code class="ruby">      i+=1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2233">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2234">
          
          
          <code class="ruby">    if letter==&quot;&quot; or number==0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2235">
          
          
          <code class="ruby">      raise ArgumentError</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2236">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2237">
          
          
          <code class="ruby">    return letter,number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2238">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2239">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2240">
          
          
          <code class="ruby">  #def sum(s,expression)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2241">
          
          
          <code class="ruby">  #  arg = expression.split(':')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2242">
          
          
          <code class="ruby">  #  b,z = split_coord(arg[0])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2243">
          
          
          <code class="ruby">  #  first_row = z</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2244">
          
          
          <code class="ruby">  #  first_col = OpenOffice.letter_to_number(b)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2245">
          
          
          <code class="ruby">  #  b,z = split_coord(arg[1])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2246">
          
          
          <code class="ruby">  #  last_row = z</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2247">
          
          
          <code class="ruby">  #  last_col = OpenOffice.letter_to_number(b)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2248">
          
          
          <code class="ruby">  #  result = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2249">
          
          
          <code class="ruby">  #  first_row.upto(last_row) {|row|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2250">
          
          
          <code class="ruby">  #    first_col.upto(last_col) {|col|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2251">
          
          
          <code class="ruby">  #      result = result + s.cell(row,col)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2252">
          
          
          <code class="ruby">  #    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2253">
          
          
          <code class="ruby">  #  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2254">
          
          
          <code class="ruby">  #  result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2255">
          
          
          <code class="ruby">  #end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2256">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2257">
          
          
          <code class="ruby">  #def test_dsl</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2258">
          
          
          <code class="ruby">  #  s = OpenOffice.new(File.join(TESTDIR,&quot;numbers1.ods&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2259">
          
          
          <code class="ruby">  #  s.default_sheet = s.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2260">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2261">
          
          
          <code class="ruby">  #    s.set 'a',1, 5</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2262">
          
          
          <code class="ruby">  #    s.set 'b',1, 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2263">
          
          
          <code class="ruby">  #    s.set 'c',1, 7</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2264">
          
          
          <code class="ruby">  #    s.set('a',2, s.cell('a',1)+s.cell('b',1))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2265">
          
          
          <code class="ruby">  #    assert_equal 8, s.cell('a',2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2266">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2267">
          
          
          <code class="ruby">  #    assert_equal 15, sum(s,'A1:C1')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2268">
          
          
          <code class="ruby">  #  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2269">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2270">
          
          
          <code class="ruby">  #def test_create_spreadsheet1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2271">
          
          
          <code class="ruby">  #  name = File.join(TESTDIR,'createdspreadsheet.ods')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2272">
          
          
          <code class="ruby">  #  rm(name) if File.exists?(File.join(TESTDIR,'createdspreadsheet.ods'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2273">
          
          
          <code class="ruby">  #  # anlegen, falls noch nicht existierend</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2274">
          
          
          <code class="ruby">  #  s = OpenOffice.new(name,true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2275">
          
          
          <code class="ruby">  #  assert File.exists?(name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2276">
          
          
          <code class="ruby">  #end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2277">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2278">
          
          
          <code class="ruby">  #def test_create_spreadsheet2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2279">
          
          
          <code class="ruby">  #  # anlegen, falls noch nicht existierend</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2280">
          
          
          <code class="ruby">  #  s = OpenOffice.new(File.join(TESTDIR,&quot;createdspreadsheet.ods&quot;),true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2281">
          
          
          <code class="ruby">  #  s.set 'a',1,42</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2282">
          
          
          <code class="ruby">  #  s.set 'b',1,43</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2283">
          
          
          <code class="ruby">  #  s.set 'c',1,44</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2284">
          
          
          <code class="ruby">  #  s.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2285">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2286">
          
          
          <code class="ruby">  #  t = OpenOffice.new(File.join(TESTDIR,&quot;createdspreadsheet.ods&quot;))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2287">
          
          
          <code class="ruby">  #  assert_equal 42, t.cell(1,'a')</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2288">
          
          
          <code class="ruby">  #  assert_equal 43, t.cell('b',1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2289">
          
          
          <code class="ruby">  #  assert_equal 44, t.cell('c',3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2290">
          
          
          <code class="ruby">  #end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2291">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2292">
          
          
          <code class="ruby">  # We don't have the bode-v1.xlsx test file</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2293">
          
          
          <code class="ruby">  # #TODO: xlsx-Datei anpassen!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2294">
          
          
          <code class="ruby">  # def test_excelx_download_uri_and_zipped</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2295">
          
          
          <code class="ruby">  #   #TODO: gezippte xlsx Datei online zum Testen suchen</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2296">
          
          
          <code class="ruby">  #   if EXCELX</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2297">
          
          
          <code class="ruby">  #     if ONLINE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2298">
          
          
          <code class="ruby">  #       url = 'http://stiny-leonhard.de/bode-v1.xlsx.zip'</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2299">
          
          
          <code class="ruby">  #       excel = Roo::Excelx.new(url, :zip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2300">
          
          
          <code class="ruby">  #       assert_equal 'ist &quot;e&quot; im Nenner von H(s)', excel.cell('b', 5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2301">
          
          
          <code class="ruby">  #     end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2302">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2303">
          
          
          <code class="ruby">  # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2304">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2305">
          
          
          <code class="ruby">  # def test_excelx_zipped</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2306">
          
          
          <code class="ruby">  #   # TODO: bode...xls bei Gelegenheit nach .xlsx konverieren lassen und zippen!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2307">
          
          
          <code class="ruby">  #   if EXCELX</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2308">
          
          
          <code class="ruby">  #     # diese Datei gibt es noch nicht gezippt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2309">
          
          
          <code class="ruby">  #     excel = Roo::Excelx.new(File.join(TESTDIR,&quot;bode-v1.xlsx.zip&quot;), :zip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2310">
          
          
          <code class="ruby">  #     assert excel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2311">
          
          
          <code class="ruby">  #     assert_raises(ArgumentError) {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2312">
          
          
          <code class="ruby">  #       assert_equal 'ist &quot;e&quot; im Nenner von H(s)', excel.cell('b', 5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2313">
          
          
          <code class="ruby">  #     }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2314">
          
          
          <code class="ruby">  #     excel.default_sheet = excel.sheets.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2315">
          
          
          <code class="ruby">  #     assert_equal 'ist &quot;e&quot; im Nenner von H(s)', excel.cell('b', 5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2316">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2317">
          
          
          <code class="ruby">  # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2318">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2319">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_csv_parsing_with_headers</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2320">
          
          
          <code class="ruby">    return unless CSV</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2321">
          
          
          <code class="ruby">    headers = [&quot;TITEL&quot;, &quot;VERFASSER&quot;, &quot;OBJEKT&quot;, &quot;NUMMER&quot;, &quot;SEITE&quot;, &quot;INTERNET&quot;, &quot;PC&quot;, &quot;KENNUNG&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2322">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2323">
          
          
          <code class="ruby">    oo = Roo::Spreadsheet.open(File.join(TESTDIR, 'Bibelbund.csv'))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2324">
          
          
          <code class="ruby">    parsed = oo.parse(:headers =&gt; true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2325">
          
          
          <code class="ruby">    assert_equal headers, parsed[1].keys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2326">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2328">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_bug_numbered_sheet_names</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2329">
          
          
          <code class="ruby">    with_each_spreadsheet(:name=&gt;'bug-numbered-sheet-names', :format=&gt;:excelx) do |oo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="2330">
          
          
          <code class="ruby">      assert_nothing_raised() { oo.each_with_pagename { } }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2331">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2332">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2333">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2334">
          
          
          <code class="ruby">end # class</code>
        </li>
      
    </ol>
  </pre>
</div>
      
      </div>
    </div>
  </body>
</html>
